/*!
 * ProjectName v1.0.0 (http://thetheme.io/theadmin)
 * Copyright 2019 TheTheme.io
 * Licensed under the Themeforest Standard Licenses
 */

"use strict";function readUrlMenu(a){var b=a.split("/"),c=2;console.log(b),"index.php"===b[1]&&b.length>1&&(c=3),"super-administration"===b[c]&&(c+=1),""===b[b.length-1]&&b.pop(),$(".menu-item").removeClass("active"),$("#menu-"+b[c]).addClass("active")}function addCallout(a,b){var c='<div class="callout callout-'+b+'" role="alert">\n                    <button type="button" class="close" data-dismiss="callout" aria-label="Close">\n                        <span>&times;</span>\n                    </button>\n                    <h5>'+b+"</h5>\n                    <p>"+a+"</p>\n                </div>";$("#mainContent").prepend(c).slideDown("slow"),$(".callout").delay(5e3).slideUp("slow")}app.config({autoload:!0,provide:["datatables","quill","momentjs","chartjs"],googleApiKey:"AIzaSyDRBLFOTTh2NFM93HpUA4ZrA99yKnCAsto",googleAnalyticsId:"",smoothScroll:!1,saveState:!1,cacheBust:""}),readUrlMenu($(location).attr("pathname")),$(document).on("click",".supprimer",function(a){a.preventDefault();var b=$(this).attr("href"),c=$(this).data("csrf");swal({title:"Are you sure?",text:"You won't be able to revert this!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",confirmButtonClass:"btn btn-primary",cancelButtonClass:"btn btn-secondary",buttonsStyling:!1}).then(function(a){console.log(a),a.value?(console.log(b),$.ajax({url:b,type:"DELETE",data:{_token:c},success:function(a){$("#ligne_"+a).closest("tr").remove(),addCallout("Suppression effectuée avec succès","success"),swal("Deleted!","Your file has been deleted.","success")},error:function(a,b,c){swal("Error deleting!","Please try again","error"),addCallout("Erreur lors de la tentative de suppression","danger")}})):"cancel"===a.dismiss&&swal("Cancelled","Your imaginary file is safe :)","error")})});const langueFr={decimal:"",emptyTable:"Aucune donn&eacute;e disponible dans le tableau",info:"Affichage de l'&eacute;l&eacute;ment _START_ &agrave; _END_ sur _TOTAL_ &eacute;l&eacute;ments",infoEmpty:"Affichage de l'&eacute;l&eacute;ment 0 &agrave; 0 sur 0 &eacute;l&eacute;ment",infoFiltered:"(filtr&eacute; de _MAX_ &eacute;l&eacute;ments au total)",infoPostFix:"",thousands:",",lengthMenu:"Afficher _MENU_ &eacute;l&eacute;ments",loadingRecords:"Chargement en cours...",processing:"Traitement en cours...",search:"Rechercher&nbsp;:",zeroRecords:"Aucun &eacute;l&eacute;ment &agrave; afficher",paginate:{first:"Premier",last:"Dernier",next:"Suivant",previous:"Pr&eacute;c&eacute;dent"},aria:{sortAscending:": activer pour trier la colonne par ordre croissant",sortDescending:": activer pour trier la colonne par ordre d&eacute;croissant"}};app.ready(function(){function a(){for(var a=0,b=0,c=0,d=0,e=0,f=0,g=1;g<=m;g++)a+=parseFloat($("#cm_"+g).val())*parseInt($("#gr_cm_"+g).val()),b+=parseFloat($("#td_"+g).val())*parseInt($("#gr_td_"+g).val()),c+=parseFloat($("#tp_"+g).val())*parseInt($("#gr_tp_"+g).val()),f=f+a+b+c,e=e+parseFloat($("#cm_"+g).val())+parseFloat($("#td_"+g).val())+parseFloat($("#tp_"+g).val());$("#totalCm").html(a.toFixed(2)),$("#totalTd").html(b.toFixed(2)),$("#totalTp").html(c.toFixed(2)),$("#totalEqTd").html(d.toFixed(2)),$("#totalEtu").html(e.toFixed(2)),$("#totalMatiere").html(f.toFixed(2))}function b(a,b){$.ajax({type:"GET",url:Routing.generate("application_personnel_absence_get_ajax",{matiere:$("#absence-matiere").val()}),dataType:"json",success:function(c){n=c;var d=a.split("/"),e=d[2].trim()+"-"+d[1].trim()+"-"+d[0].trim();if(void 0!==n[e]&&void 0!==n[e][b])for(var f=0;f<n[e][b].length;f++)$("#etu_"+n[e][b][f]).addClass("absent")}})}function c(a){$(".event").each(function(b){$(this).data("type-event")===a&&$(this).hide()})}function d(a){$(".event").each(function(b){$(this).data("type-event")===a&&$(this).show()})}function e(a){"E"===a?$(".event").each(function(b){$(this).data("qui-event")===a&&$(this).hide()}):$(".event").each(function(b){$(this).hasClass(a)&&$(this).hide()})}function f(a){"E"===a?$(".event").each(function(b){$(this).data("qui-event")===a&&$(this).show()}):$(".event").each(function(b){$(this).hasClass(a)&&$(this).show()})}function g(a,b,c){$.ajax({url:Routing.generate("application_personnel_disponibilite_update"),data:{jour:a,heure:b,etat:c},method:"POST"})}function h(a,b,c){$.ajax({url:Routing.generate("administration_creneau_bloque_modifie_etat"),data:{creneau:b,type:a,semaine:c},method:"POST"})}function i(a,b,c,d){$.ajax({url:Routing.generate("application_personnel_progression_update",{matiere:c}),data:{semaine:a,typecours:b,nbSeances:d},method:"POST"})}function j(a,b,c){var d=parseInt($("#nbgr_cm_"+c).text()),e=parseInt($("#nbgr_td_"+c).text()),f=parseInt($("#nbgr_tp_"+c).text()),g="tot_s"+a+"_"+c,h=parseInt($("#"+g+"_cm").val());isNaN(h)&&(h=0);var i=parseInt($("#"+g+"_td").val());isNaN(i)&&(i=0);var j=parseInt($("#"+g+"_tp").val());isNaN(j)&&(j=0);var k=h*d*1.5+i*e*1.5+j*f*1.5;$("#"+g).text(k);var l="tot_cm_"+c,m="tot_td_"+c,n="tot_tp_"+c,o="tot_cm_seance_"+c,p="tot_td_seance_"+c,q="tot_tp_seance_"+c,r="tot_"+c,s="tot_seance_"+c,t="tot_cm_h_"+c,u="tot_td_h_"+c,v="tot_tp_h_"+c,w="tot_h_"+c,x=0,y=0,z=0;$(".cm_"+c).each(function(){var a=parseInt($(this).val());isNaN(a)&&(a=0),x+=a}),console.log(x),$("#"+o).text(x),$("#"+l).text(x*d),$("#"+t).text(1.5*x*d),$(".td_"+c).each(function(){var a=parseInt($(this).val());isNaN(a)&&(a=0),y+=a}),$("#"+p).text(y),$("#"+m).text(y*e),$("#"+u).text(1.5*y*e),$(".tp_"+c).each(function(){var a=parseInt($(this).val());isNaN(a)&&(a=0),z+=a}),$("#"+q).text(z),$("#"+n).text(z*f),$("#"+v).text(1.5*z*f),$("#"+s).text(x+y+z),$("#"+r).text(x*d+y*e+z*f),$("#"+w).text(1.5*x*d+1.5*y*e+1.5*z*f)}function k(){for(var a=Array(),b=1;b<15;b++)a[b]=0;a.total=0,a.total_groupe=0,a.total_heure=0,$(".une_matiere").each(function(){for(var b=$(this).data("matiere"),c=parseInt($("#nbgr_cm_"+b).text()),d=parseInt($("#nbgr_td_"+b).text()),e=parseInt($("#nbgr_tp_"+b).text()),f=0,g=0,h=0,i=1;i<15;i++){var j="tot_s"+i+"_"+b,k=parseInt($("#"+j+"_cm").val());isNaN(k)&&(k=0),f+=k;var l=parseInt($("#"+j+"_td").val());isNaN(l)&&(l=0),g+=l;var m=parseInt($("#"+j+"_tp").val());isNaN(m)&&(m=0),h+=m;var n=k*c*1.5+l*d*1.5+m*e*1.5;$("#"+j).text(n),a[i]+=n}var o="tot_cm_"+b,p="tot_td_"+b,q="tot_tp_"+b,r="tot_cm_seance_"+b,s="tot_td_seance_"+b,t="tot_tp_seance_"+b,u="tot_"+b,v="tot_seance_"+b,w="tot_cm_h_"+b,x="tot_td_h_"+b,y="tot_tp_h_"+b,z="tot_h_"+b;$("#"+r).text(f),$("#"+o).text(f*c),$("#"+w).text(1.5*f*c),$("#"+s).text(g),$("#"+p).text(g*d),$("#"+x).text(1.5*g*d),$("#"+t).text(h),$("#"+q).text(h*e),$("#"+y).text(1.5*h*e),$("#"+v).text(f+g+h),$("#"+u).text(f*c+g*d+h*e),$("#"+z).text(1.5*f*c+1.5*g*d+1.5*h*e),a.total+=f+g+h,a.total_groupe+=f*c+g*d+h*e,a.total_heure+=1.5*f*c+1.5*g*d+1.5*h*e});for(var b=1;b<15;b++)$("#tot_s"+b).text(a[b]);$("#tot_seance").text(a.total),$("#tot_global_groupe").text(a.total_groupe),$("#tot_global_heure").text(a.total_heure)}$(".custom-file input").change(function(a){for(var b=[],c=0;c<$(this)[0].files.length;c++)b.push($(this)[0].files[c].name);$(this).next(".custom-file-label").html(b.join(", "))});$(document).on("click",".page-link",function(a){a.preventDefault(),a.stopPropagation();var b=$("#zone-pagination");b.empty(),b.load($(this).attr("href"))}),$(document).on("click",".changeprofil",function(a){a.preventDefault(),a.stopPropagation(),$(".changeprofil").removeClass("active show"),$(this).addClass("active show"),$("#profilContent").empty().load($(this).attr("href"))}),$(document).on("change",".addfavori",function(a){a.preventDefault(),a.stopPropagation(),$.ajax({url:Routing.generate("user_add_favori"),method:"POST",data:{user:$(this).val(),etat:$(this).prop("checked")}})}),$(document).on("click",".afficheDocuments",function(){$("#zone_document").empty().load(Routing.generate("document_ajax",{typedocument:$(this).data("type")})),$("#boutonBack").show()}),$(document).on("click","#boutonBack",function(){$("#zone_document").empty().load(Routing.generate("typedocument_ajax")),$("#boutonBack").hide()}),$(document).on("click",".semestretrombi",function(a){a.preventDefault(),$(".semestretrombi").removeClass("active show"),$(".enseignanttrombi").removeClass("active show"),$(this).addClass("active show"),$("#trombi").slideUp().empty().load(Routing.generate("trombinoscope_etudiant_semestre",{semestre:$(this).data("sem")})).slideDown()}),$(document).on("click",".changeTypeGroupe",function(a){a.preventDefault(),$("#trombi").slideUp().empty().load(Routing.generate("trombinoscope_etudiant_semestre",{semestre:$(this).data("semestre"),typegroupe:$(this).data("typegroupe")})).slideDown()}),$(document).on("click",".enseignanttrombi",function(a){a.preventDefault(),$(".semestretrombi").removeClass("active show"),$(".enseignanttrombi").removeClass("active show"),$(this).addClass("active show"),$("#trombi").slideUp().empty().load(Routing.generate("trombinoscope_personnel",{type:$(this).data("type")})).slideDown()}),$(document).on("keyup","#login_urca",function(){var a=$(this).val();console.log(a),a.length>2&&$.ajax({url:Routing.generate("api_personnel_recherche",{needle:a}),dataType:"json",success:function(a){$("#result").empty(),jQuery.each(a,function(a,b){var c="<tr><td>"+b.nom+"</td><td>"+b.prenom+"</td><td>"+b.username+"</td><td>"+b.mail_univ+'</td><td><a href="#" class="btn btn-success btn-outline btn-square addpersonnel" data-provide="tooltip" data-placement="bottom" title="Ajouter à la departement" data-slug="'+b.slug+'"><i class="ti-plus"></i></a></td></tr>';$("#result").append(c)})}})}),$(document).on("click",".addpersonnel",function(){$.ajax({url:Routing.generate("api_personnel_add_to_departement",{slug:$(this).data("slug")}),dataType:"json",success:function(a){addCallout("Personnel ajouté au département !","success")}})}),$(document).on("keyup","#sa_login_urca",function(){var a=$(this).data("departement"),b=$(this).val();console.log(b),b.length>2&&$.ajax({url:Routing.generate("api_personnel_recherche",{needle:b}),dataType:"json",success:function(b){$("#result").empty(),jQuery.each(b,function(b,c){var d="<tr><td>"+c.nom+"</td><td>"+c.prenom+"</td><td>"+c.username+"</td><td>"+c.mail_univ+'</td><td><a href="#" class="btn btn-success btn-outline btn-square sa_addpersonnel" data-provide="tooltip" data-placement="bottom" title="Ajouter au departement" data-slug="'+c.slug+'" data-departement="'+a+'"><i class="ti-plus"></i></a></td></tr>';$("#result").append(d)})}})}),$(document).on("click",".sa_addpersonnel",function(){$.ajax({url:Routing.generate("api_personnel_add_to_departement",{slug:$(this).data("slug"),departement:$(this).data("departement")}),dataType:"json",success:function(a){addCallout("Personnel ajouté au departement !","success")}})}),$(document).on("click",".personnel_index_change",function(){$(".personnel_index_change").removeClass("active show"),$(this).addClass("active show");var a=$("#tableau").DataTable();a.clear(),a.destroy(),$.ajax({url:Routing.generate("api_enseignants_type",{type:$(this).data("type")}),dataType:"json",success:function(a){jQuery.each(a,function(a,b){var c="<tr>\n                        <td>"+b.nom+"</td>\n                        <td>"+b.prenom+"</td>\n                        <td>"+b.posteInterne+"</td>\n                        <td>"+b.telBureau+"</td>\n                        <td>"+b.bureau1+"</td>\n                        <td>"+b.numeroHarpege+"</td>\n                        <td>"+b.mailUniv+'</td>\n                        <td>\n<a href="'+Routing.generate("administration_personnel_show",{id:b.id})+'" class="btn btn-info btn-outline btn-square" data-provide="tooltip"\n   data-placement="bottom" title="Détails"><i class="fa fa-info"></i></a>\n<a href="'+Routing.generate("administration_personnel_edit",{id:b.id})+'"\n   class="btn btn-warning btn-outline btn-square"><i class="fa fa-edit"\n                                                     data-provide="tooltip"\n                                                     data-placement="bottom"\n                                                     title="Modifier"></i></a>\n<a href="'+Routing.generate("administration_personnel_delete",{id:b.id})+'" class="btn btn-danger btn-outline btn-square supprimer" data-id="id"><i\n            class="fa fa-trash" data-provide="tooltip" data-placement="bottom"\n            title="Supprimer"></i></a>';$("#datatableau").append(c)}),$("#tableau").DataTable({})}})}),$("#datatableRh").DataTable({processing:!0,serverSide:!0,langue:langueFr,ajax:Routing.generate("api_all_personnel"),sAjaxDataProp:"data",pageLength:25,columns:[{data:"numero_harpege"},{data:"nom"},{data:"prenom"},{data:"departements"},{data:"deleted"},{data:"id",sortable:!1,mRender:function(a,b,c){return'<a href="'+Routing.generate("sa_rh_personnel_show",{id:a})+'" class="btn btn-info btn-outline btn-square" data-provide="tooltip"\n   data-placement="bottom" title="Détails"><i class="fa fa-info"></i></a>\n<a href="'+Routing.generate("sa_rh_personnel_edit",{id:a})+'"\n   class="btn btn-warning btn-outline btn-square"\n                                                     data-provide="tooltip"\n                                                     data-placement="bottom"\n                                                     title="Modifier"><i class="fa fa-edit"></i></a>\n<a href="'+Routing.generate("sa_rh_delete_personnel",{id:a})+'" class="btn btn-danger btn-outline btn-square supprimer" data-id="id"            data-provide="tooltip" data-placement="bottom"\n            title="Supprimer"><i class="fa fa-trash"></i></a>'}}]}),$(document).on("change",".change_droit_pf",function(){$.ajax({url:Routing.generate("sa_personnel_departement_modifier_droit",{pf:$(this).data("pf")}),method:"POST",data:{droit:$(this).val()},success:function(a){addCallout("Droits modifiés !","success")}})});var l=$("#datatableEtudiants").DataTable({});l.clear(),l.destroy(),$("#datatableEtudiants").DataTable({language:langueFr,processing:!0,serverSide:!0,ajax:Routing.generate("api_etudiant_departement"),sAjaxDataProp:"data",columns:[{data:"numetudiant"},{data:"nom"},{data:"prenom"},{data:"semestre"},{data:"profil"}]}),$(document).on("click",".admChangeTypeGroupe",function(){$(".admChangeTypeGroupe").removeClass("btn-primary"),$(this).addClass("btn-primary"),$("#listeEtudiantsGroupes").empty().load(Routing.generate("administration_etudiant_groupe_affecte",{typeGroupe:$(this).data("typegroupe")}))}),$(document).on("click",".changegroupe",function(){if($(this).is(":checked")){var a=$(this).val(),b="#"+$(this).attr("name")+"_old";console.log(b),$.ajax({url:Routing.generate("administration_etudiant_groupe_change"),type:"POST",data:{id:$(this).attr("name")+"-"+$(this).val(),typegroupe:$("#autocom").val(),oldgroupe:$(b).val()},success:function(c){$(b).val(a)}})}}),$(document).on("click",".changeapplication",function(a){a.preventDefault(),a.stopPropagation(),$(".changeapplication").removeClass("active show"),$(this).addClass("active show"),$("#mainContent").empty().load($(this).attr("href"))}),$(document).on("change","#selectsemestre",function(){$("#listegroupe").empty();var a=$("#selectmatiere"),b=$("#selectgroupes");$.ajax({url:Routing.generate("api_matieres_semestre",{semestre:$(this).val()}),dataType:"json",success:function(b){a.empty(),a.append($("<option></option>").attr("value","").text("Choisir une matière")),jQuery.each(b,function(b,c){a.append($("<option></option>").attr("value",c.id).text(c.libelle))})},error:function(){}}),$.ajax({url:Routing.generate("api_type_groupe_semestre",{semestre:$(this).val()}),dataType:"json",success:function(a){b.empty(),b.append($("<option></option>").attr("value","").text("Choisir un type de groupe")),jQuery.each(a,function(a,c){b.append($("<option></option>").attr("value",c.id).text(c.libelle))})},error:function(){}})}),$(document).on("change","#selectgroupes",function(){var a=$("#listegroupe");$.ajax({url:Routing.generate("api_groupe_type_groupe",{typeGroupe:$(this).val()}),dataType:"json",success:function(b){a.empty();var c="";jQuery.each(b,function(a,b){c+='<input type="checkbox" checked name="detail_groupes[]" value="'+b.id+'"> '+b.libelle+" | "}),a.html(c)},error:function(){}})}),$(document).on("click","#add_rattrapage",function(){$("#bloc_add_rattrapage").toggle()}),$(document).on("click","#add_carnet",function(){$("#bloc_add_carnet").toggle()});var m=1;$(document).on("change","#previSemestre",function(a){a.preventDefault(),a.stopPropagation(),$("#blocPrevisionnel").empty().load(Routing.generate("administration_previsionnel_semestre",{semestre:$(this).val(),annee:$(this).data("annee")}))}),$(document).on("click","#reloadPreviSemestre",function(a){a.preventDefault(),a.stopPropagation(),$("#blocPrevisionnel").empty().load(Routing.generate("administration_previsionnel_semestre",{semestre:$(this).data("semestre"),annee:$(this).data("annee")}))}),$(document).on("change","#previMatiere",function(a){a.preventDefault(),a.stopPropagation(),$("#blocPrevisionnel").empty().load(Routing.generate("administration_previsionnel_matiere",{matiere:$(this).val(),annee:$(this).data("annee")}))}),$(document).on("click","#reloadPreviMatiere",function(a){a.preventDefault(),a.stopPropagation(),$("#blocPrevisionnel").empty().load(Routing.generate("administration_previsionnel_matiere",{matiere:$(this).data("matiere"),annee:$(this).data("annee")}))}),$(document).on("change","#previPersonnel",function(a){a.preventDefault(),a.stopPropagation(),$("#blocPrevisionnel").empty().load(Routing.generate("administration_previsionnel_personnel",{personnel:$(this).val(),annee:$(this).data("annee")}))}),$(document).on("click","#reloadPreviPersonnel",function(a){a.preventDefault(),a.stopPropagation(),$("#blocPrevisionnel").empty().load(Routing.generate("administration_previsionnel_personnel",{personnel:$(this).data("personnel"),annee:$(this).data("annee")}))}),$(document).on("click",".previsionnel_add_change",function(a){a.preventDefault(),a.stopPropagation(),$(".previsionnel_add_change").removeClass("active show"),$(this).addClass("active show"),$("#mainContent").empty().load($(this).attr("href"))}),$(document).on("click","#addIntervenantPrevisionnel",function(a){a.preventDefault(),a.stopPropagation(),m++;var b='<tr>\n                        <td>\n                            <select class="form-control">\n                                <option value="">Choisir l\'intervenant</option>\n                            </select>\n                        </td>\n                        <td><input type="text" name="cm_1" id="cm_'+m+'" data-ligne="1" class="form-control chgcm" value="0"></td>\n                        <td><input type="number" name="gr_cm_1" id="gr_cm_'+m+'" value="0" data-ligne="1" class="form-control chgcm">\n                        </td>\n                        <td id="ind_cm_'+m+'">0</td>\n                        <td style="background-color: #68C39F"><input type="text" value="0" name="td_'+m+'" id="td_'+m+'" data-ligne="'+m+'"\n                                                                     class="form-control chgtd"></td>\n                        <td style="background-color: #68C39F"><input type="number" value="0" name="gr_td_'+m+'" id="gr_td_'+m+'"\n                                                                     data-ligne="'+m+'" class="form-control chgtd"></td>\n                        <td style="background-color: #68C39F" id="ind_td_'+m+'">0</td>\n                        <td style="background-color: #FFC052"><input type="text" value="0" name="tp_'+m+'" id="tp_'+m+'" data-ligne="'+m+'"\n                                                                     class="form-control chgtp"></td>\n                        <td style="background-color: #FFC052"><input type="number" value="0" name="gr_tp_'+m+'" id="gr_tp_'+m+'"\n                                                                     data-ligne="'+m+'" class="form-control chgtp"></td>\n                        <td style="background-color: #FFC052" id="ind_tp_'+m+'">0</td>\n                    </tr>';$("#nbLigne").val(m),$("#ligneAdd").before(b)}),$(document).on("change",".chgcm",function(b){var c=$(this).data("ligne"),d=parseFloat($("#cm_"+c).val())/1.5;$("#ind_cm_"+c).html(d.toFixed(2)),a()}),$(document).on("change",".chgtd",function(b){var c=$(this).data("ligne"),d=parseFloat($("#td_"+c).val())/1.5;$("#ind_td_"+c).html(d.toFixed(2)),a()}),$(document).on("change",".chgtp",function(b){var c=$(this).data("ligne"),d=parseFloat($("#tp_"+c).val())/1.5;$("#ind_tp_"+c).html(d.toFixed(2)),a()}),$(document).on("change","#previsionnel_semestre",function(){var a=$("#previsionnel_matiere");""==$(this).val()?(a.empty(),a.append($("<option></option>").attr("value","").text("Choisir d'abord un semestre"))):$.ajax({url:Routing.generate("api_matieres_semestre",{semestre:$(this).val()}),success:function(b){a.empty(),a.append($("<option></option>").attr("value","").text("Choisir une matière")),jQuery.each(b,function(b,c){a.append($("<option></option>").attr("value",c.id).text(c.libelle))})}})}),$(document).on("change","#previsionnel_matiere",function(){var a=$("#volumeMatiere");""==$(this).val()?a.html("Choisir d'abord une matière"):$.ajax({url:Routing.generate("api_matiere",{matiere:$(this).val()}),success:function(b){var c="PPN Officiel => CM "+b.cmFormation+" heure(s); TD "+b.tdFormation+" heure(s); TP "+b.tpFormation+" heure(s); PPN Réalisé/departement => CM "+b.cmPpn+" heure(s); TD "+b.tdPpn+" heure(s); TP "+b.tpPpn+" heure(s);";a.html(c)}})}),$(document).on("click","#btnGenereFichier",function(a){a.preventDefault(),a.stopPropagation();var b=[];$("input:checkbox[name=exportChamps]:checked").each(function(){b.push($(this).val())}),$.ajax({url:Routing.generate("export_listing.fr"),method:"POST",data:{matiere:$(this).data("matiere"),exportTypeDocument:$("input[type=radio][name=exportTypeDocument]:checked").val(),exportChamps:b,exportFormat:$("input[type=radio][name=exportFormat]:checked").val(),exportFiltre:$("input[type=radio][name=exportFiltre]:checked").val()},success:function(a){}})}),$(document).on("change","#change_annee_temp_hrs",function(a){window.location=Routing.generate("administration_hrs_index",{annee:$(this).val()})}),$(document).on("change","#change_annee_temp_previsionnel",function(a){window.location=Routing.generate("administration_previsionnel_index",{annee:$(this).val()})}),$(document).on("click",".changeinformation",function(a){a.preventDefault(),a.stopPropagation(),console.log($(this).text()),$("#header-title").empty().append($(this).text()),$(".changeinformation").removeClass("active show"),$(this).addClass("active show"),$("#mainContent").empty().load($(this).attr("href"))}),$(".edit").editable("fichier.php",{type:"text",cancel:"Cancel",cancelcssclass:"btn btn-danger",submitcssclass:"btn btn-success",submit:"Save",tooltip:"Click to edit..."}),$(document).on("change",".changeOption",function(a){a.preventDefault(),a.stopPropagation(),$.ajax({url:Routing.generate("administration_configuration_change_option"),method:"POST",data:{type:$(this).data("type"),value:$(this).prop("checked"),name:$(this).attr("name"),id:$(this).data("id")},success:function(a){addCallout("Configuration enregistrée","success")},error:function(a){addCallout("Erreur lors de l'enregistrement de la configuration","danger")}})}),$(document).on("change",".changeOptionSelect",function(a){$.ajax({url:Routing.generate("administration_configuration_change_option"),method:"POST",data:{type:$(this).data("type"),value:$(this).val(),name:$(this).attr("name"),id:$(this).data("id")},success:function(a){addCallout("Configuration enregistrée","success")},error:function(a){addCallout("Erreur lors de l'enregistrement de la configuration","danger")}})}),$(document).on("click",".messagerie-filtre",function(a){a.preventDefault(),a.stopPropagation(),$("#messages-liste").empty().load(Routing.generate("messagerie_filtre",{filtre:$(this).data("filtre")}))}),$(document).on("click",".message-read",function(a){a.preventDefault(),a.stopPropagation(),$("#messages-liste").empty().load(Routing.generate("messagerie_message",{message:$(this).data("message")}))}),$(document).on("click","#new-message",function(a){a.preventDefault(),a.stopPropagation(),$("#messages-liste").empty().load(Routing.generate("messagerie_nouveau"))}),$(document).on("click","#marquerNotificationsRead",function(a){a.preventDefault(),a.stopPropagation(),$.ajax({url:Routing.generate("notification_marquer_lu"),success:function(a){$(".notification").removeClass("media-new")}})}),$(document).on("click","#valideDestinataires",function(){var a="";$("input[type='checkbox']:checked").each(function(){a=a+"; "+$(this).val(),console.log($(this).val())}),$("#messageTo").val(a)}),$(document).on("click","#messageSent",function(a){a.preventDefault(),a.stopPropagation(),$.ajax({url:Routing.generate("messagerie_sent"),data:{destinataires:$("#messageTo").val(),copie:$("#messageCopy").val(),message:$(".ql-editor").html(),sujet:$("#messageSubject").val()},method:"POST",success:function(a){}})}),$(document).on("click",".starred",function(){$.ajax({url:Routing.generate("messagerie_starred"),method:"POST",data:{valeur:$(this).is(":checked"),message:$(this).dataAttr("message")},error:function(){$(this).prop("checked",!1)}})});var n=[];$(document).on("change","#justifier_etudiant",function(a){var b=$("#tableJustifier").DataTable();b.clear(),b.destroy(),$.ajax({url:Routing.generate("administration_absences_liste_absence_etudiant",{etudiant:$(this).val()}),success:function(a){var b=$("#tableJustifier").empty();b.append("<thead>\n                <tr>\n                    <th>Date</th>\n                    <th>Heure</th>\n                    <th>Matière</th>\n                    <th>Justifier</th>\n                    <th>Actions</th>\n                </tr>\n                </thead><tbody>"),jQuery.each(a,function(a,c){var d="<tr>\n                        <td>"+c.date+"</td>\n                        <td>"+c.heure+"</td>\n                        <td>"+c.matiere+'</td>\n                        <td><input type="radio" value="true" data-absence="'+c.id+'" name="radio_'+c.id+'" class="justifieAbsence"';!0===c.justifie&&(d+=" checked "),d=d+'> Oui | <input type="radio" value="false" data-absence="'+c.id+'" name="radio_'+c.id+'" class="justifieAbsence"',!1===c.justifie&&(d+=" checked "),d+='> Non</td>\n                        <td><a href="" class="btn btn-danger supprimer"><i class="ti-close"></i></a></td>\n                    </tr>',b.append(d)}),b.append("</tbody>"),b.dataTable({language:langueFr})}})}),$(document).on("click",".justifieAbsence",function(){console.log($(this).val()),$.ajax({type:"GET",url:Routing.generate("administration_absences_justifie",{absence:$(this).data("absence"),etat:$(this).val()}),error:function(a,b){addCallout("Erreur lors de l'enregistrement.","danger")},success:function(a){!0===a?addCallout("Absence justifiée avec succés !","success"):addCallout("Absence non justifiée avec succés !","warning")}})}),$(document).on("click",".absChangeTypeGroupe",function(a){a.preventDefault(),a.stopPropagation(),$("#listeEtudiantsAbsences").load(Routing.generate("api_absence_liste_etudiant",{typegroupe:$(this).data("typegroupe")}));var c=$("#absence-date"),d=$("#absence-heure");b(c.val(),d.val())}),$(document).on("change","#absence-matiere",function(){var a=$(".etudiant"),c=$("#absence-date"),d=$("#absence-heure");a.removeClass("absent"),b(c.val(),d.val())}),$(document).on("change","#absence-date",function(){var a=$(".etudiant"),c=$("#absence-date"),d=$("#absence-heure");a.removeClass("absent"),b(c.val(),d.val())}),$(document).on("change","#absence-heure",function(){var a=$(".etudiant"),c=$("#absence-date"),d=$("#absence-heure");a.removeClass("absent"),b(c.val(),d.val())}),$(document).on("click",".etudiant",function(){var a=$(this).attr("id").split("_");$(this).hasClass("absent")?($(this).removeClass("absent"),$.ajax({type:"POST",url:Routing.generate("application_personnel_absence_saisie_ajax",{matiere:$("#absence-matiere").val(),etudiant:a[1]}),dataType:"json",data:{date:$("#absence-date").val(),heure:$("#absence-heure").val(),action:"suppr"},error:function(a,b){addCallout("Le délai pour l'enregistrement est dépassé. Contactez le responsable de la departement","danger")},success:function(a){n=a,addCallout("La suppression a été effectuée avec succés !","success")}})):($(this).addClass("absent"),$.ajax({type:"POST",url:Routing.generate("application_personnel_absence_saisie_ajax",{matiere:$("#absence-matiere").val(),etudiant:a[1]}),dataType:"json",data:{date:$("#absence-date").val(),heure:$("#absence-heure").val(),action:"saisie"},error:function(a,b){"out"==a.responseText?addCallout("Le délai pour l'enregistrement est dépassé. Contactez le responsable de la departement","danger"):addCallout("Erreur lors de l'enregistrement.","danger")},success:function(a){n=a,console.log("ajout"),console.log(n),addCallout("Absence enregistrée avec succés !","success")}}))}),$("#liste-absences").dataTable({language:langueFr,fnRowCallback:function(a,b,c,d){"non"==b[6]||"no"==b[6]||"No"==b[6]||"Non"==b[6]?$("td",a).css("background-color","#fce3e3"):$("td",a).css("background-color","#e3fcf2")}}),$(document).on("click",".justificatif-accepte",function(a){var b=$(this).data("justificatif");$.ajax({url:Routing.generate("administration_absence_justificatif_change_etat",{uuid:b,etat:"A"}),success:function(a){var c=$(".bx_"+b),d=c.parent();c.remove(),d.prepend('<a href="#" class="btn btn-success btn-outline"><i class="ti-check"></i>Accepté</a>'),addCallout("Justificatif d'absence validé !","success")},error:function(a){addCallout("Une erreur est survenue !","danger")}})}),$(document).on("click",".justificatif-refuse",function(a){var b=$(this).data("justificatif");$.ajax({url:Routing.generate("administration_absence_justificatif_change_etat",{uuid:b,etat:"R"}),success:function(a){var c=$(".bx_"+b),d=c.parent();c.remove(),d.prepend('<a href="#" class="btn btn-warning btn-outline"><i class="ti-check"></i>Refusé</a>'),addCallout("Justificatif d'absence refusé !","success")},error:function(a){addCallout("Une erreur est survenue !","danger")}})}),$(document).on("click",".justificatif-annuler",function(a){var b=$(this).data("justificatif");$.ajax({url:Routing.generate("administration_absence_justificatif_change_etat",{uuid:b,etat:"D"}),success:function(a){var c=$(".bx_"+b),d=c.parent();c.remove();var e='<a href="#"\n                               class="btn btn-success btn-outline btn-square justificatif-accepte bx_'+b+'" data-provide="tooltip"\n                               data-justificatif="'+b+'"\n                               data-placement="bottom" title="atitle.accepter.le.justificatif"><i\n                                        class="ti-check"></i></a>\n                            <a href="#"\n                               class="btn btn-warning btn-outline btn-square justificatif-refuse bx_'+b+'" data-provide="tooltip"\n                               data-justificatif="'+b+'"\n                               data-placement="bottom" title="atitle.refuser.le.justificatif"><i\n                                        class="ti-na"></i></a>\n\n                            <a href="'+Routing.generate("administration_absence_justificatif_delete",{id:b})+'" data-csrf="{{ csrf_token(\'delete\' ~ justificatif.uuidString) }}"\n                               class="btn btn-danger btn-outline btn-square supprimer bx_'+b+'"><i\n                                        class="ti-close" data-provide="tooltip" data-placement="bottom"\n                                        title="atitle.supprimer"></i></a>';d.prepend(e),addCallout("Etat du justificatif d'absence annulé !","success")},error:function(a){addCallout("Une erreur est survenue !","danger")}})}),$(".savegroupe").click(function(){var a=$(this).attr("id");console.log(a);var b={notes:[]};$(".noteetudiant:input").each(function(){if($(this).hasClass(a)){var c=$(this).data("etudiant"),d={id:c,note:$(this).val(),commentaire:$("#com_"+c).val()};b.notes.push(d)}}),$.ajax({
url:Routing.generate("application_personnel_note_ajax_saisie",{uuid:$(this).data("evaluation")}),type:"POST",data:{notes:b},success:function(a){addCallout("Les notes de <strong>ce groupe</strong> ont été enregistrées avec succés ! Vous pouvez les modifier !","success")},error:function(){addCallout("Une erreur est survenue pendant l'envoi... <br>Veuillez réessayer","danger")}})}),$(document).on("keyup",".noteetudiant",function(a){var b=$(this).val();"-0.01"==b?$(this).addClass("is-valid"):parseFloat(b)>=0&&parseFloat(b)<=20?$(this).addClass("is-valid"):$(this).addClass("is-invalid")}),$(document).on("click",".articleLike",function(a){a.preventDefault(),a.stopPropagation();var b=$(this);$.ajax({url:Routing.generate("article_like",{slug:$(this).data("article")}),success:function(a){b.html('<i class="ti-heart text-danger fs-11"></i> '+a)}})}),$(document).on("keyup","#search",function(a){var b=$(this).val();console.log(b);var c=$("#search_reponse_etudiant"),d=$("#search_reponse_personnel"),e=$("#search_reponse_autre");if(b.length>2)$.ajax({url:Routing.generate("recherche",{keyword:b}),dataType:"json",success:function(a){var f="";a.etudiants.length>0?jQuery.each(a.etudiants,function(a,b){f=f+'<a class="media" href="'+Routing.generate("user_profil",{type:"etudiant",slug:b.slug})+'" target="_blank">\n                <span class="avatar status-dark">\n                  <img src="'+basePath+"photo/"+b.photo+'" alt="Photo de profil de '+b.displayPr+'">\n                </span>\n\n                        <div class="media-body">\n                            <p><strong>'+b.displayPr+'</strong>\n                                <time class="float-right" datetime="2018-07-14 20:00">Groupes...</time>\n                            </p>\n                        </div>\n                    </a>'}):f='<div class="alert alert-warning">Pas de résultat pour votre rehcerche <strong>"'+b+'"</strong></div>',c.slideUp().empty().append(f).slideDown(),f="",a.personnels.length>0?jQuery.each(a.personnels,function(a,b){f=f+'<a class="media items-center" href="'+Routing.generate("user_profil",{type:"personnel",slug:b.slug})+'" target="_blank">\n                        <img class="avatar avatar-sm" src="'+basePath+"photo/"+b.photo+'" alt="Photo de profil de '+b.displayPr+'">\n                        <p>'+b.displayPr+"</p>\n                    </a>"}):f='<div class="alert alert-warning">Pas de résultat pour votre rehcerche <strong>"'+b+'"</strong></div>',d.slideUp().empty().append(f).slideDown(),f="",a.autres.length>0?jQuery.each(a.autres,function(a,b){f=f+'<a class="media items-center" href="">\n                        <img class="avatar avatar-sm" src="../assets/img/avatar/1.jpg" alt="...">\n                        <p>'+b+"</p>\n                    </a>"}):f='<div class="alert alert-warning">Pas de résultat pour votre rehcerche <strong>"'+b+'"</strong></div>',e.slideUp().empty().append(f).slideDown()}});else{var f='<div class="alert alert-info">Saisir au moins 3 caractères</div>';e.slideUp().empty().append(f).slideDown(),d.slideUp().empty().append(f).slideDown(),c.slideUp().empty().append(f).slideDown()}}),$(document).on("click",".rattrapage-accepte",function(a){var b=$(this).data("rattrapage");$.ajax({url:Routing.generate("administration_rattrapage_change_etat",{uuid:b,etat:"A"}),success:function(a){var c=$(".bx_"+b),d=c.parent();c.remove(),d.prepend('<a href="#" class="btn btn-success btn-outline"><i class="ti-check"></i>Acceptée</a>'),addCallout("Demande de rattrapage validée !","success")},error:function(a){addCallout("Une erreur est survenue !","danger")}})}),$(document).on("click",".rattrapage-refuse",function(a){var b=$(this).data("rattrapage");$.ajax({url:Routing.generate("administration_rattrapage_change_etat",{uuid:b,etat:"R"}),success:function(a){var c=$(".bx_"+b),d=c.parent();c.remove(),d.prepend('<a href="#" class="btn btn-warning btn-outline"><i class="ti-na"></i>Refusée</a>'),addCallout("Demande de rattrapage refusée !","success")},error:function(a){addCallout("Une erreur est survenue !","danger")}})}),$(document).on("click",".optAfficher",function(a){var b=$(this).data("id"),c=$(this).children("i"),d=$(this);$.ajax({url:Routing.generate("administration_evaluation_visibilite",{uuid:b}),success:function(a){c.hasClass("fa-eye")?(d.addClass("btn-danger"),d.removeClass("btn-info").removeClass("btn-outline"),c.removeClass("fa-eye"),c.addClass("fa-eye-slash"),d.attr("title","Evaluation masquée. Rendre visible l'évaluation")):(d.removeClass("btn-danger"),d.addClass("btn-info").addClass("btn-outline"),c.removeClass("fa-eye-slash"),c.addClass("fa-eye"),d.attr("title","Evaluation visible. Masquer l'évaluation")),addCallout("Visibilité de l'évaluation modifiée !","success")},error:function(a){addCallout("Une erreur est survenue !","danger")}})}),$(document).on("click",".optVerrouiller",function(a){var b=$(this).data("id"),c=$(this).children("i"),d=$(this);$.ajax({url:Routing.generate("administration_evaluation_modifiable",{uuid:b}),success:function(a){$(this).children("i").hasClass("fa-pencil")?(d.addClass("btn-danger"),d.removeClass("btn-warning").removeClass("btn-outline"),c.children("i").removeClass("fa-pencil"),c.children("i").addClass("fa-lock"),d.attr("data-original-title","Modification interdite. Autoriser la modificaiton")):(d.removeClass("btn-danger"),d.addClass("btn-warning").addClass("btn-outline"),c.children("i").removeClass("fa-lock"),c.addClass("fa-pencil"),d.attr("data-original-title","Modification autorisée. Interdire la modification")),addCallout("Vérouillage de l'évaluation modifiée !","success")},error:function(a){addCallout("Une erreur est survenue !","danger")}})}),$(document).on("click",".filtreTypeDate",function(a){var b=$(this),e=b.data("type");b.hasClass("btn-outline")?(d(e),b.removeClass("btn-outline")):(b.addClass("btn-outline"),c(e))}),$(document).on("click",".filtreUtilisateurDate",function(a){var b=$(this),c=b.data("type");b.hasClass("btn-outline")?(f(c),b.removeClass("btn-outline")):(b.addClass("btn-outline"),e(c))}),$(document).on("change",".departementParDefaut",function(a){$.ajax({url:Routing.generate("user_change_departement_defaut",{departement:$(this).val()}),method:"POST",success:function(a){addCallout("Mofification enregistrée !","success")},error:function(a){addCallout("Erreur lors de la sauvegarde de la modification !","danger")}})}),$("#matiere_semestre").change(function(){var a=$(this);$.ajax({url:Routing.generate("api_liste_ue_by_semestre"),dataType:"JSON",type:"POST",data:{semestreid:a.val()},success:function(b){var c=$("#matiere_ue");c.html(""),c.append("<option value> Choisir une UE dans le semestre "+a.find("option:selected").text()+" ...</option>"),$.each(b,function(a,b){c.append('<option value="'+b.id+'">'+b.numeroUe+" "+b.libelle+"</option>")})},error:function(a){alert("An error ocurred while loading data ...")}}),$.ajax({url:Routing.generate("api_liste_parcour_by_semestre"),dataType:"JSON",type:"POST",data:{semestreid:a.val()},success:function(b){var c=$("#matiere_parcours");c.html(""),c.append("<option value> Choisir (optionnel) un parcour pour le semestre "+a.find("option:selected").text()+" ...</option>"),$.each(b,function(a,b){c.append('<option value="'+b.id+'">'+b.libelle+"</option>")})},error:function(a){alert("An error ocurred while loading data ...")}}),$.ajax({url:Routing.generate("api_matieres_semestre",{semestre:a.val()}),dataType:"JSON",type:"GET",success:function(a){var b=$("#matiere_matiereParent");b.html(""),b.append("<option value> Choisir (optionnel) une matière parent pour "+$("#matiere_libelle").val()+" ...</option>"),$.each(a,function(a,c){b.append('<option value="'+c.id+'">'+c.display+"</option>")})},error:function(a){alert("An error ocurred while loading data ...")}})}),$(document).on("click",".change-diplome",function(a){a.preventDefault(),$(".change-diplome").removeClass("active show"),$(this).addClass("active show"),$.ajax({url:Routing.generate("administration_matiere_diplome",{diplome:$(this).data("diplome")}),dataType:"HTML",type:"GET",success:function(a){$("#content_diplome").slideUp().empty().append(a).slideDown(),$(".datatable_matieres").dataTable({language:langueFr})}})}),$(document).on("change","#tuteurUniversitaire",function(a){$.ajax({url:Routing.generate("administration_alternance_update_tuteur_universitaire",{alternance:$(this).data("alternance"),personnel:$(this).val()}),success:function(a){addCallout("Justificatif d'absence refusé !","success")},error:function(a){addCallout("Une erreur est survenue !","danger")}})}),$(document).on("keyup","#etudiant",function(){var a=$(this).val();console.log(a),a.length>2&&$("#resultat").empty().load(Routing.generate("sa_scolarite_recherche",{needle:a}))}),$(document).on("click",".visibiliteBorne",function(){var a=$(this);$.ajax({url:Routing.generate("administration_borne_visibilite",{id:a.data("id")}),success:function(b){console.log(b),!1===b?(addCallout("Message masqué avec succés !","success"),a.removeClass("btn-success").addClass("btn-danger"),a.children("i").removeClass("fa-eye").addClass("fa-eye-slash"),a.attr("title","Message masqué. Rendre visible")):(addCallout("Message affiché avec succés !","success"),a.removeClass("btn-danger").addClass("btn-success"),a.children("i").removeClass("fa-eye-slash").addClass("fa-eye"),a.attr("title","Message affiché. Rendre invisible"))}})}),$(document).on("change",".typegroupe_defaut",function(a){$.ajax({url:Routing.generate("administration_type_groupe_defaut"),method:"POST",data:{typegroupe:$(this).val()},success:function(a){addCallout("Type de groupe par défaut enregistré","success")},error:function(a){addCallout("Erreur lors de l'enregistrement du type de groupe par défaut","danger")}})}),$(document).on("click","#add_type_groupe",function(){var a=$(this).data("semestre");$.ajax({url:Routing.generate("administration_type_groupe_new"),method:"POST",data:{libelle:$("#type_groupe_libelle").val(),semestre:a,defaut:$("#type_groupe_defaut").prop("checked")},success:function(b){$("#typgeGroupe_bloc").empty().load(Routing.generate("administration_type_groupe_refresh",{semestre:a})),addCallout("Type de groupe ajouté","success")},error:function(a){addCallout("Erreur lors de l'ajout du type de groupe","danger")}})}),$(document).on("click",".add_groupe",function(){var a=$(this).data("parent");$.ajax({url:Routing.generate("administration_groupe_new"),method:"POST",data:{libelle:$("#groupe_libelle_"+a).val(),code:$("#groupe_code_apogee_"+a).val(),type:$("#groupe_type_groupe_"+a).val(),parcours:$("#groupe_parcours_"+a).val(),parent:a},success:function(b){$("#groupe_bloc").empty().load(Routing.generate("administration_groupe_refresh",{parent:a})),addCallout("Groupe ajouté","success")},error:function(a){addCallout("Erreur lors de l'ajout du groupe","danger")}})}),$(document).on("click","#btn_creneau_add",function(){var a=$("#change_annee_universitiare_temp").val();$.ajax({method:"POST",data:{anneeUniversitaire:a,jour:$("#creneau_jour").val(),debut:$("#creneau_debut").val(),fin:$("#creneau_fin").val()},url:Routing.generate("administration_creneau_cours_new"),success:function(){$("#liste_creneaux").empty().load(Routing.generate("administration_creneau_cours_liste",{annee_universitaire:a})),addCallout("Créneau ajouté avec succès","success")},error:function(){addCallout("Erreur lors de l'ajout du créneau","danger")}})}),$(document).on("click",".bloquercreneau",function(){var a=$(this);console.log("click"),a.hasClass("bloquercreneau_eviter")?(h("dispo",a.data("creneau"),a.data("semaine")),a.removeClass("bloquercreneau_eviter")):a.hasClass("bloquercreneau_interdit")?(a.removeClass("bloquercreneau_interdit"),a.addClass("bloquercreneau_eviter"),h("au",a.data("creneau"),a.data("semaine"))):(a.addClass("bloquercreneau_interdit"),h("va",a.data("creneau"),a.data("semaine")))}),$(document).on("click",".creneau",function(){var a=$("#nb_interdit"),b=$("#nb_eviter"),c=$("#nb_dispo"),d=$(this).data("heure"),e=$(this).dataAttr("jour"),f=parseInt(a.text()),h=parseInt(b.text()),i=parseInt(c.text());$(this).hasClass("bloquercreneau_interdit")?($(this).removeClass("bloquercreneau_interdit"),$(this).addClass("bloquercreneau_eviter"),f--,h++,g(e,d,"E")):$(this).hasClass("bloquercreneau_eviter")?($(this).removeClass("bloquercreneau_eviter"),h--,i++,g(e,d,"D")):($(this).addClass("bloquercreneau_interdit"),f++,i--,g(e,d,"I")),a.text(f),b.text(h),c.text(i)}),$(document).on("change",".updateProgression",function(){console.log("update"),i($(this).data("semaine"),$(this).data("type"),$(this).data("matiere"),$(this).val()),j($(this).data("semaine"),$(this).data("type"),$(this).data("matiere"))}),$(document).on("click","#refresh",function(){k()}),$("#editCourrier");var o=$(".preloader");if(o.length){var p=o.dataAttr("hide-spped",600);o.fadeOut(p)}$(document).on({ajaxStart:function(){o.show()},ajaxStop:function(){o.hide()}}),$(".callout").delay(5e3).slideUp("slow")});