/*!
 * ProjectName v1.0.0 (http://thetheme.io/theadmin)
 * Copyright 2020 TheTheme.io
 * Licensed under the Themeforest Standard Licenses
 */

"use strict";function readUrlMenu(e){const t=e.split("/");let a=2;"index.php"===t[1]&&t.length>1&&(a=3),"super-administration"===t[a]&&(a+=1),""===t[t.length-1]&&t.pop(),$(".menu-item").removeClass("active"),$("#menu-"+t[a]).addClass("active")}function updateAffichage(e,t){$.ajax({type:"GET",url:Routing.generate("application_personnel_absence_get_ajax",{matiere:$("#absence-matiere").val()}),dataType:"json",success:function(a){const n=e.split("/"),i=n[2].trim()+"-"+n[1].trim()+"-"+n[0].trim();4===t.length&&(t="0"+t);for(let e in a)if(e==i&&void 0!==a[e][t])for(let n=0;n<a[e][t].length;n++)$("#etu_"+a[e][t][n]).addClass("absent")}})}function addCallout(e,t){const a='<div class="callout callout-'+t+'" role="alert">\n                    <button type="button" class="close" data-dismiss="callout" aria-label="Close">\n                        <span>&times;</span>\n                    </button>\n                    <h5>'+t+"</h5>\n                    <p>"+e+"</p>\n                </div>";$("#mainContent").prepend(a).slideDown("slow"),$(".callout").delay(5e3).slideUp("slow")}app.config({autoload:!0,provide:["datatables","quill","momentjs","chartjs","jqueryui"],googleApiKey:"AIzaSyDRBLFOTTh2NFM93HpUA4ZrA99yKnCAsto",googleAnalyticsId:"",smoothScroll:!1,saveState:!1,cacheBust:""}),readUrlMenu($(location).attr("pathname")),$(document).on("click",".supprimer",function(e){e.preventDefault();const t=$(this).attr("href"),a=$(this).data("csrf");swal({title:"Confirmer la suppression ?",text:"L'opération ne pourra pas être annulée.",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Oui, je confirme",cancelButtonText:"Non, Annuler",confirmButtonClass:"btn btn-primary",cancelButtonClass:"btn btn-secondary",buttonsStyling:!1}).then(function(e){e.value?$.ajax({url:t,type:"DELETE",data:{_token:a},success:function(e){e.hasOwnProperty("redirect")&&e.hasOwnProperty("url")?document.location.href=e.url:($("#ligne_"+e).closest("tr").remove(),addCallout("Suppression effectuée avec succès","success"),swal("Supprimé!","L'enregistrement a été supprimé.","success"))},error:function(e,t,a){console.log(t),console.log(a),swal("Erreur lors de la suppression!","Merci de renouveler l'opération","error"),addCallout("Erreur lors de la tentative de suppression","danger")}}):"cancel"===e.dismiss&&swal("Cancelled","OK! Tout est comme avant !","error")})});let myEditInitialContent="";function updateData(){let e=$("#myedit-input").val();$.ajax({url:myEditInitialContent.attr("href"),data:{field:myEditInitialContent.data("field"),value:e},method:"POST",success:function(){myEditInitialContent.html(e),$("#myEdit-zone").replaceWith(myEditInitialContent)}})}function genereInput(e){let t='<div id="myEdit-zone"><input type="text" value="'+e.html()+'" id="myedit-input" />';return t+='<button class="btn btn-square btn-sm btn-success btn-outline" id="myedit-valide"><i class="ti-check"></i></button>',t+='<button class="btn btn-square btn-sm btn-danger btn-outline" id="myedit-annule"><i class="ti-close"></i></button></div>'}$(document).on("click",".myedit",function(e){e.preventDefault(),myEditInitialContent=$(this);let t=genereInput($(this));$(this).replaceWith(t),$("#myedit-input").focus()}),$(document).on("keyup","#myedit-input",function(e){13===e.keyCode?updateData():27===e.keyCode&&$("#myEdit-zone").replaceWith(myEditInitialContent)}),$(document).on("click","#myedit-valide",function(e){e.preventDefault(),updateData()}),$(document).on("click","#myedit-annule",function(e){e.preventDefault(),$("#myEdit-zone").replaceWith(myEditInitialContent)});const langueFr={decimal:"",emptyTable:"Aucune donn&eacute;e disponible dans le tableau",info:"Affichage de l'&eacute;l&eacute;ment _START_ &agrave; _END_ sur _TOTAL_ &eacute;l&eacute;ments",infoEmpty:"Affichage de l'&eacute;l&eacute;ment 0 &agrave; 0 sur 0 &eacute;l&eacute;ment",infoFiltered:"(filtr&eacute; de _MAX_ &eacute;l&eacute;ments au total)",infoPostFix:"",thousands:",",lengthMenu:"Afficher _MENU_ &eacute;l&eacute;ments",loadingRecords:"Chargement en cours...",processing:"Traitement en cours...",search:"Rechercher&nbsp;:",zeroRecords:"Aucun &eacute;l&eacute;ment &agrave; afficher",paginate:{first:"Premier",last:"Dernier",next:"Suivant",previous:"Pr&eacute;c&eacute;dent"},aria:{sortAscending:": activer pour trier la colonne par ordre croissant",sortDescending:": activer pour trier la colonne par ordre d&eacute;croissant"}},iconShow="fa fa-info",iconEdit="fa fa-edit",iconDelete="fa fa-trash",iconPrint="fa fa-print",iconDuplicate="fa fa-copy";app.ready(function(){$(document).on("click","#copyLink",function(){$("#lienIcal").select(),document.execCommand("copy")}),$(".custom-file input").change(function(e){const t=[];for(let e=0;e<$(this)[0].files.length;e++)t.push($(this)[0].files[e].name);$(this).next(".custom-file-label").html(t.join(", "))});$(document).on("click",".page-link",function(e){e.preventDefault(),e.stopPropagation();const t=$("#zone-pagination");t.empty(),t.load($(this).attr("href"))}),$(document).on("click",".changeprofil",function(e){e.preventDefault(),e.stopPropagation(),$(".changeprofil").removeClass("active show"),$(this).addClass("active show"),$("#profilContent").empty().load($(this).attr("href"))}),$(document).on("change",".addfavori",function(e){e.preventDefault(),e.stopPropagation(),$.ajax({url:Routing.generate("user_add_favori"),method:"POST",data:{user:$(this).val(),etat:$(this).prop("checked")}})}),$(document).on("click","#btnabs",function(e){$.ajax({url:Routing.generate("administration_absences_ajax_add"),data:{etudiant:$(this).data("etudiant"),date:$("#jourabs").val(),matiere:$("#moduleabs").val(),heure:$("#heureabs").val(),justif:$("input[type=radio][name=justifabs]:checked").val()},method:"POST",success:function(e){let t="",a="",n="";!0===e.justifie?(t="bg-pale-success",a="Oui",n="checked"):(t="bg-pale-warning",a="Non",n="");let i='<tr class="'+t+'" id="ligne_'+e.id+'">\n                    <td>'+e.date+"</td>\n                    <td>"+e.heure+"</td>\n                    <td>"+e.codeMatiere+"</td>\n                    <td>"+a+'</td>\n                    <td class="hide">'+e.personnel+'</td>\n                    <td>\n                        <button data-provide="modaler tooltip"\n                                data-url="'+Routing.generate("app_etudiant_absence_detail",{uuid:e.uuidString})+'"\n                                class="btn btn-info btn-outline btn-square btn-xs"\n                                data-placement="bottom"\n                                title="Détails"\n                                data-title="Détails de l\'absence"\n                        >\n                            <i class="'+iconShow+'"></i>\n                        </button>\n                    </td>\n                        <td>\n                            <div class="custom-control custom-control-lg custom-checkbox">\n                                <input type="checkbox" class="custom-control-input checkAbsence" id="check_'+e.id+'"\n                                       data-absence="'+e.id+'" '+n+'>\n                                <label class="custom-control-label" for="check_'+e.id+'">Justifiée*</label>\n                            </div>\n                        </td>\n                </tr>';$("#tableAbsence > tbody:last").append(i)}})}),$(document).on("click",".checkAbsence",function(e){let t=$(this).data("absence"),a=1;$(this).is(":checked")&&(a=0),console.log(a),$.ajax({url:Routing.generate("administration_absences_justifie",{absence:t,etat:a}),type:"GET",success:function(e){e?$("#ligne_"+t).removeClass("bg-pale-warning").addClass("bg-pale-success"):$("#ligne_"+t).removeClass("bg-pale-success").addClass("bg-pale-warning")}})}),$(document).on("click",".afficheDocuments",function(){$("#zone_document").empty().load(Routing.generate("document_ajax",{typedocument:$(this).data("type")})),$("#boutonBack").show()}),$(document).on("click","#boutonBack",function(){$("#zone_document").empty().load(Routing.generate("typedocument_ajax")),$("#boutonBack").hide()}),$(document).on("click",".semestretrombi",function(e){e.preventDefault(),$(".semestretrombi").removeClass("active show"),$(".enseignanttrombi").removeClass("active show"),$(this).addClass("active show"),$("#trombi").slideUp().empty().load(Routing.generate("trombinoscope_etudiant_semestre",{semestre:$(this).data("sem")})).slideDown()}),$(document).on("click",".changeTypeGroupe",function(e){e.preventDefault(),$("#trombi").slideUp().empty().load(Routing.generate("trombinoscope_etudiant_semestre",{semestre:$(this).data("semestre"),typegroupe:$(this).data("typegroupe")})).slideDown()}),$(document).on("click",".enseignanttrombi",function(e){e.preventDefault(),$(".semestretrombi").removeClass("active show"),$(".enseignanttrombi").removeClass("active show"),$(this).addClass("active show"),$("#trombi").slideUp().empty().load(Routing.generate("trombinoscope_personnel",{type:$(this).data("type")})).slideDown()}),$(document).on("keyup","#login_urca",function(){const e=$(this).val();console.log(e),e.length>2&&$.ajax({url:Routing.generate("api_personnel_recherche",{needle:e}),dataType:"json",success:function(e){$("#result").empty(),jQuery.each(e,function(e,t){const a="<tr><td>"+t.nom+"</td><td>"+t.prenom+"</td><td>"+t.username+"</td><td>"+t.mail_univ+'</td><td><a href="#" class="btn btn-success btn-outline btn-square addpersonnel" data-provide="tooltip" data-placement="bottom" title="Ajouter au departement" data-slug="'+t.slug+'"><i class="ti-plus"></i></a></td></tr>';$("#result").append(a)})}})}),$(document).on("click",".addpersonnel",function(){$.ajax({url:Routing.generate("api_personnel_add_to_departement",{slug:$(this).data("slug")}),dataType:"json",success:function(e){addCallout("Personnel ajouté au département !","success")}})}),$(document).on("keyup","#sa_login_urca",function(){const e=$(this).data("departement"),t=$(this).val();console.log(t),t.length>2&&$.ajax({url:Routing.generate("api_personnel_recherche",{needle:t}),dataType:"json",success:function(t){$("#result").empty(),jQuery.each(t,function(t,a){const n="<tr><td>"+a.nom+"</td><td>"+a.prenom+"</td><td>"+a.username+"</td><td>"+a.mail_univ+'</td><td><a href="#" class="btn btn-success btn-outline btn-square sa_addpersonnel" data-provide="tooltip" data-placement="bottom" title="Ajouter au departement" data-slug="'+a.slug+'" data-departement="'+e+'"><i class="ti-plus"></i></a></td></tr>';$("#result").append(n)})}})}),$(document).on("click",".sa_addpersonnel",function(){$.ajax({url:Routing.generate("api_personnel_add_to_departement",{slug:$(this).data("slug"),departement:$(this).data("departement")}),dataType:"json",success:function(e){addCallout("Personnel ajouté au departement !","success")}})}),$(document).on("click",".personnel_index_change",function(){$(".personnel_index_change").removeClass("active show"),$(this).addClass("active show");const e=$("#tableau").DataTable();e.clear(),e.destroy(),$.ajax({url:Routing.generate("api_enseignants_type",{type:$(this).data("type")}),dataType:"json",success:function(e){jQuery.each(e,function(e,t){const a="<tr>\n                        <td>"+t.nom+"</td>\n                        <td>"+t.prenom+"</td>\n                        <td>"+t.posteInterne+"</td>\n                        <td>"+t.telBureau+"</td>\n                        <td>"+t.bureau1+"</td>\n                        <td>"+t.numeroHarpege+"</td>\n                        <td>"+t.mailUniv+'</td>\n                        <td>\n<a href="'+Routing.generate("administration_personnel_show",{id:t.id})+'" class="btn btn-info btn-outline btn-square" data-provide="tooltip"\n   data-placement="bottom" title="Détails"><i class="fa fa-info"></i></a>\n<a href="'+Routing.generate("administration_personnel_edit",{id:t.id})+'"\n   class="btn btn-warning btn-outline btn-square"><i class="fa fa-edit"\n                                                     data-provide="tooltip"\n                                                     data-placement="bottom"\n                                                     title="Modifier"></i></a>\n<a href="'+Routing.generate("administration_personnel_delete",{id:t.id})+'" class="btn btn-danger btn-outline btn-square supprimer" data-id="id"><i\n            class="fa fa-trash" data-provide="tooltip" data-placement="bottom"\n            title="Supprimer"></i></a>                        </td>\n                    </tr>';$("#datatableau").append(a)}),$("#tableau").DataTable({})}})}),$("#datatableRh").DataTable({processing:!0,serverSide:!0,langue:langueFr,ajax:Routing.generate("api_all_personnel"),sAjaxDataProp:"data",pageLength:25,order:[[1,"asc"]],columns:[{data:"numero_harpege"},{data:"nom"},{data:"prenom"},{data:"login"},{data:"departements"},{data:"deleted"},{data:"id",sortable:!1,mRender:function(e,t,a){return'<a href="'+Routing.generate("sa_rh_personnel_show",{id:e})+'" class="btn btn-info btn-outline btn-square" data-provide="tooltip"\n   data-placement="bottom" title="Détails"><i class="fa fa-info"></i></a>\n<a href="'+Routing.generate("sa_rh_personnel_edit",{id:e})+'"\n   class="btn btn-warning btn-outline btn-square"\n                                                     data-provide="tooltip"\n                                                     data-placement="bottom"\n                                                     title="Modifier"><i class="fa fa-edit"></i></a>\n<a href="'+Routing.generate("sa_rh_delete_personnel",{id:e})+'" class="btn btn-danger btn-outline btn-square supprimer" data-id="id"            data-provide="tooltip" data-placement="bottom"\n            title="Supprimer"><i class="fa fa-trash"></i></a>'}}]}),$(document).on("change",".change_droit_pf",function(){$.ajax({url:Routing.generate("sa_personnel_departement_modifier_droit",{pf:$(this).data("pf")}),method:"POST",data:{droit:$(this).val()},success:function(e){addCallout("Droits modifiés !","success")}})}),$(document).on("change",".updateRole",function(){$.ajax({url:Routing.generate("admin_personnel_departement_modifier_droit",{personnel:$("#personnel").val()}),method:"POST",data:{droit:$(this).val()},success:function(e){addCallout("Droits modifiés !","success")}})});const e=$("#datatableEtudiants").DataTable({});e.clear(),e.destroy(),$("#datatableEtudiants").DataTable({language:langueFr,processing:!0,serverSide:!0,ajax:Routing.generate("api_etudiant_departement"),sAjaxDataProp:"data",columns:[{data:"numetudiant"},{data:"nom"},{data:"prenom"},{data:"semestre"},{data:"profil"}]}),$(document).on("click",".admChangeTypeGroupe",function(){$(".admChangeTypeGroupe").removeClass("btn-primary"),$(this).addClass("btn-primary"),$("#listeEtudiantsGroupes").empty().load(Routing.generate("administration_etudiant_groupe_affecte",{typeGroupe:$(this).data("typegroupe")}))}),$(document).on("click",".changegroupe",function(){if($(this).is(":checked")){const e=$(this).val(),t="#"+$(this).attr("name")+"_old";console.log(t),$.ajax({url:Routing.generate("administration_etudiant_groupe_change"),type:"POST",data:{id:$(this).attr("name")+"-"+$(this).val(),typegroupe:$("#autocom").val(),oldgroupe:$(t).val()},success:function(a){$(t).val(e)}})}}),$(document).on("click",".changeapplication",function(e){e.preventDefault(),e.stopPropagation(),$(".changeapplication").removeClass("active show"),$(this).addClass("active show"),$("#mainContent").empty().load($(this).attr("href"))}),$(document).on("change","#selectsemestre",function(){$("#listegroupe").empty();const e=$("#selectmatiere"),t=$("#selectgroupes");$.ajax({url:Routing.generate("api_matieres_semestre",{semestre:$(this).val()}),dataType:"json",success:function(t){e.empty(),e.append($("<option></option>").attr("value","").text("Choisir une matière")),jQuery.each(t,function(t,a){e.append($("<option></option>").attr("value",a.id).text(a.display))}),e.attr("data-provide","selectpicker"),e.attr("data-live-search","true")},error:function(){addCallout("Erreur lors de la tentative d'affichage des matières du semestres. Veuillez contacter le responsable de l'intranet si le problème persiste !","error")}}),$.ajax({url:Routing.generate("api_type_groupe_semestre",{semestre:$(this).val()}),dataType:"json",success:function(e){t.empty(),t.append($("<option></option>").attr("value","").text("Choisir un type de groupe")),jQuery.each(e,function(e,a){t.append($("<option></option>").attr("value",a.id).text(a.libelle))})},error:function(){addCallout("Erreur lors de la tentative d'affichage des groupes du semestres. Veuillez contacter le responsable de l'intranet si le problème persiste !","error")}})}),$(document).on("change","#selectgroupes",function(){const e=$("#listegroupe");$.ajax({url:Routing.generate("api_groupe_type_groupe",{typeGroupe:$(this).val()}),dataType:"json",success:function(t){e.empty();let a="";jQuery.each(t,function(e,t){a+='<input type="checkbox" checked name="detail_groupes[]" value="'+t.id+'"> '+t.libelle+" | "}),e.html(a)},error:function(){addCallout("Erreur lors de la tentative d'affichage des groupes du semestres. Veuillez contacter le responsable de l'intranet si le problème persiste !","error")}})}),$(document).on("click","#add_rattrapage",function(){$("#bloc_add_rattrapage").toggle()}),$(document).on("click","#add_carnet",function(){$("#bloc_add_carnet").toggle()});let t=1;function a(){let e=0,a=0,n=0,i=0,o=0,s=0,r=0,l=0;for(let i=1;i<=t;i++){let t=$("#cm_"+i),c=$("#td_"+i),u=$("#tp_"+i);e+=parseFloat(t.val())*parseInt($("#gr_cm_"+i).val()),a+=parseFloat(c.val())*parseInt($("#gr_td_"+i).val()),n+=parseFloat(u.val())*parseInt($("#gr_tp_"+i).val()),s+=parseFloat(t.val()),r+=parseFloat(c.val()),l+=parseFloat(u.val()),o=o+parseFloat(t.val())+parseFloat(c.val())+parseFloat(u.val())}i=e+a+n,$("#totalCm").html(e.toFixed(2)),$("#totalTd").html(a.toFixed(2)),$("#totalTp").html(n.toFixed(2)),$("#totalEqTd").html(i.toFixed(2)),$("#totalEtu").html(o.toFixed(2)),$("#totalHeuresCm").html(s.toFixed(2)),$("#totalHeuresTd").html(r.toFixed(2)),$("#totalHeuresTp").html(l.toFixed(2));let c=parseFloat($("#cmMaquette").html())-s,u=parseFloat($("#tdMaquette").html())-r,d=parseFloat($("#tpMaquette").html())-l;$("#diffCm").html(c.toFixed(2)),$("#diffTd").html(u.toFixed(2)),$("#diffTp").html(d.toFixed(2)),c<0?$("#diffCm").addClass("erreurPrevi").removeClass("validePrevi"):$("#diffCm").addClass("validePrevi").removeClass("erreurPrevi"),u<0?$("#diffTd").addClass("erreurPrevi").removeClass("validePrevi"):$("#diffTd").addClass("validePrevi").removeClass("erreurPrevi"),d<0?$("#diffTp").addClass("erreurPrevi").removeClass("validePrevi"):$("#diffTp").addClass("validePrevi").removeClass("erreurPrevi")}$(document).on("change","#previSemestre",function(e){e.preventDefault(),e.stopPropagation(),$("#blocPrevisionnel").empty().load(Routing.generate("administration_previsionnel_semestre",{semestre:$(this).val(),annee:$(this).data("annee")}))}),$(document).on("click","#reloadPreviSemestre",function(e){e.preventDefault(),e.stopPropagation(),$("#blocPrevisionnel").empty().load(Routing.generate("administration_previsionnel_semestre",{semestre:$(this).data("semestre"),annee:$(this).data("annee")}))}),$(document).on("change","#previMatiere",function(e){e.preventDefault(),e.stopPropagation(),$("#blocPrevisionnel").empty().load(Routing.generate("administration_previsionnel_matiere",{matiere:$(this).val(),annee:$(this).data("annee")}))}),$(document).on("click","#reloadPreviMatiere",function(e){e.preventDefault(),e.stopPropagation(),$("#blocPrevisionnel").empty().load(Routing.generate("administration_previsionnel_matiere",{matiere:$(this).data("matiere"),annee:$(this).data("annee")}))}),$(document).on("change","#previPersonnel",function(e){e.preventDefault(),e.stopPropagation(),$("#blocPrevisionnel").empty().load(Routing.generate("administration_previsionnel_personnel",{personnel:$(this).val(),annee:$(this).data("annee")}))}),$(document).on("click","#reloadPreviPersonnel",function(e){e.preventDefault(),e.stopPropagation(),$("#blocPrevisionnel").empty().load(Routing.generate("administration_previsionnel_personnel",{personnel:$(this).data("personnel"),annee:$(this).data("annee")}))}),$(document).on("click",".previsionnel_add_change",function(e){e.preventDefault(),e.stopPropagation(),$(".previsionnel_add_change").removeClass("active show"),$(this).addClass("active show"),$("#mainContent").empty().load($(this).attr("href"))}),$(document).on("click","#addIntervenantPrevisionnel",function(e){e.preventDefault(),e.stopPropagation(),t++,$.ajax({url:Routing.generate("api_enseignants_departement"),method:"POST",success:function(e){let a='<tr>\n                        <td>\n                            <select class="form-control" data-live-search="true" name="intervenant_'+t+'" id="intervenant_'+t+'">\n                                <option value="">Choisir l\'intervenant</option>\n';jQuery.each(e,function(e,t){a=a+'<option value="'+t.id+'">'+t.display+"</option>\n"}),a=a+'                            </select>\n                        </td>\n                        <td><input type="text" name="cm_'+t+'" id="cm_'+t+'" data-ligne="'+t+'" class="form-control chgcm" value="0"></td>\n                        <td><input type="number" name="gr_cm_'+t+'" id="gr_cm_'+t+'" value="0" data-ligne="'+t+'" class="form-control chgcm">\n                        </td>\n                        <td id="ind_cm_'+t+'">0</td>\n                        <td style="background-color: #68C39F"><input type="text" value="0" name="td_'+t+'" id="td_'+t+'" data-ligne="'+t+'"\n                                                                     class="form-control chgtd"></td>\n                        <td style="background-color: #68C39F"><input type="number" value="0" name="gr_td_'+t+'" id="gr_td_'+t+'"\n                                                                     data-ligne="'+t+'" class="form-control chgtd"></td>\n                        <td style="background-color: #68C39F" id="ind_td_'+t+'">0</td>\n                        <td style="background-color: #FFC052"><input type="text" value="0" name="tp_'+t+'" id="tp_'+t+'" data-ligne="'+t+'"\n                                                                     class="form-control chgtp"></td>\n                        <td style="background-color: #FFC052"><input type="number" value="0" name="gr_tp_'+t+'" id="gr_tp_'+t+'"\n                                                                     data-ligne="'+t+'" class="form-control chgtp"></td>\n                        <td style="background-color: #FFC052" id="ind_tp_'+t+'">0</td>\n                    </tr>',$("#nbLigne").val(t),$("#ligneAdd").before(a),$("#intervenant_"+t).selectpicker()}})}),$(document).on("change",".chgcm",function(e){const t=$(this).data("ligne"),n=parseFloat($("#cm_"+t).val())/1.5;$("#ind_cm_"+t).html(n.toFixed(2)),a()}),$(document).on("change",".chgtd",function(e){const t=$(this).data("ligne"),n=parseFloat($("#td_"+t).val())/1.5;$("#ind_td_"+t).html(n.toFixed(2)),a()}),$(document).on("change",".chgtp",function(e){const t=$(this).data("ligne"),n=parseFloat($("#tp_"+t).val())/1.5;$("#ind_tp_"+t).html(n.toFixed(2)),a()}),$(document).on("change","#previsionnel_matiere",function(){const e=$("#volumeMatiere");""===$(this).val()?e.html("Choisir d'abord une matière"):$.ajax({url:Routing.generate("api_matiere",{matiere:$(this).val()}),success:function(t){const a="PPN Officiel => CM "+t.cmFormation+" heure(s); TD "+t.tdFormation+" heure(s); TP "+t.tpFormation+" heure(s); PPN Réalisé/departement => CM "+t.cmPpn+" heure(s); TD "+t.tdPpn+" heure(s); TP "+t.tpPpn+" heure(s);";e.html(a),$("#cmMaquette").html(t.cmFormation),$("#totalHeuresCm").html(0),$("#diffCm").html(0),$("#tdMaquette").html(t.tdFormation),$("#totalHeuresTd").html(0),$("#diffTd").html(0),$("#tpMaquette").html(t.tpFormation),$("#totalHeuresTp").html(0),$("#diffTp").html(0),$("#tabheures").show()}})}),$(document).on("click","#btnGenereFichier",function(e){e.preventDefault(),e.stopPropagation();const t=[];$("input:checkbox[name=exportChamps]:checked").each(function(){t.push($(this).val())}),$.ajax({url:Routing.generate("export_listing.fr"),method:"POST",data:{matiere:$(this).data("matiere"),exportTypeDocument:$("input[type=radio][name=exportTypeDocument]:checked").val(),exportChamps:t,exportFormat:$("input[type=radio][name=exportFormat]:checked").val(),exportFiltre:$("input[type=radio][name=exportFiltre]:checked").val()},success:function(e){}})}),$(document).on("change","#change_annee_temp_hrs",function(e){window.location=Routing.generate("administration_hrs_index",{annee:$(this).val()})}),$(document).on("change","#change_annee_temp_previsionnel",function(e){window.location=Routing.generate("administration_previsionnel_index",{annee:$(this).val()})}),$(document).on("click",".changeinformation",function(e){e.preventDefault(),e.stopPropagation(),console.log($(this).text()),$("#header-title").empty().append($(this).text()),$(".changeinformation").removeClass("active show"),$(this).addClass("active show"),$("#mainContent").empty().load($(this).attr("href"))}),$(document).on("change",".changeOption",function(e){e.preventDefault(),e.stopPropagation(),$.ajax({url:Routing.generate("administration_configuration_change_option"),method:"POST",data:{type:$(this).data("type"),value:$(this).prop("checked"),name:$(this).attr("name"),id:$(this).data("id")},success:function(e){addCallout("Configuration enregistrée","success")},error:function(e){addCallout("Erreur lors de l'enregistrement de la configuration","danger")}})}),$(document).on("change",".changeOptionSelect",function(){$.ajax({url:Routing.generate("administration_configuration_change_option"),method:"POST",data:{type:$(this).data("type"),value:$(this).val(),name:$(this).attr("name"),id:$(this).data("id")},success:function(e){addCallout("Configuration enregistrée","success")},error:function(e){addCallout("Erreur lors de l'enregistrement de la configuration","danger")}})}),$(document).on("change",".activeAnneeUniversitaire",function(e){e.preventDefault(),e.stopPropagation(),$.ajax({url:Routing.generate("sa_annee_universitaire_change_active",{annee:$(this).data("id")}),method:"POST",data:{value:$(this).prop("checked")},success:function(e){addCallout("Configuration enregistrée","success")},error:function(e){addCallout("Erreur lors de l'enregistrement de la configuration","danger")}})}),$(document).on("click",".messagerie-filtre",function(e){e.preventDefault(),e.stopPropagation(),$("#messages-liste").empty().load(Routing.generate("messagerie_filtre",{filtre:$(this).data("filtre")}))}),$(document).on("click",".message-read",function(e){e.preventDefault(),e.stopPropagation(),$("#messages-liste").empty().load(Routing.generate("messagerie_message",{message:$(this).data("message")}))}),$(document).on("click","#new-message",function(e){e.preventDefault(),e.stopPropagation(),$("#messages-liste").empty().load(Routing.generate("messagerie_nouveau"))}),$(document).on("click","#marquerNotificationsRead",function(e){e.preventDefault(),e.stopPropagation(),$.ajax({url:Routing.generate("notification_marquer_lu"),success:function(e){$(".notification").removeClass("media-new")}})}),$(document).on("click","#messageSent",function(e){e.preventDefault(),e.stopPropagation(),$.ajax({url:Routing.generate("messagerie_sent"),data:{messageToSemestre:$("#messageToSemestre").val(),messageToGroupe:$("#messageToGroupe").val(),messageToLibreEtudiant:$("#messageToLibreEtudiant").val(),messageToLibrePersonnel:$("#messageToLibrePersonnel").val(),typeDestinataire:$("input[type=radio][name=messageDestinataireType]:checked").val(),copie:$("#messageCopy").val(),message:$(".ql-editor").html(),sujet:$("#messageSubject").val()},method:"POST",success:function(e){}})}),$(document).on("click",".starred",function(){$.ajax({url:Routing.generate("messagerie_change_etat"),method:"POST",data:{valeur:"S",message:$(this).data("message")},error:function(){$(this).prop("checked",!1)}})}),$(document).on("click","#deleteMessage",function(){console.log($(this).data("message")),$.ajax({url:Routing.generate("messagerie_change_etat"),method:"POST",data:{etat:"D",message:$(this).data("message")},success:function(){}})}),$(document).on("click",".messageDestinataireType",function(){const e=$(this).val(),t=$("#blocDestLibreEtudiant"),a=$("#blocDestLibrePersonnel"),n=$("#blocDestMessgaeInfo"),i=$("#blocDestGroupe"),o=$("#blocDestSemestre");"e"===e?(t.show(),a.hide(),n.hide(),i.hide(),o.hide()):"s"===e?(t.hide(),a.hide(),n.hide(),i.hide(),o.show()):"g"===e?(t.hide(),a.hide(),n.hide(),i.show(),o.hide()):"p"===e&&(t.hide(),a.show(),n.hide(),i.hide(),o.hide())});let n=[];function i(e,t,a){$.ajax({url:Routing.generate("application_personnel_disponibilite_update"),data:{jour:e,heure:t,etat:a},method:"POST"})}function o(e,t,a){$.ajax({url:Routing.generate("administration_creneau_bloque_modifie_etat"),data:{creneau:t,type:e,semaine:a},method:"POST"})}$(document).on("change","#justifier_etudiant",function(){let e=$("#tableJustifier").DataTable();e.clear(),e.destroy(),$.ajax({url:Routing.generate("administration_absences_liste_absence_etudiant",{etudiant:$(this).val()}),success:function(e){let t=$("#tableJustifier").empty();t.append("<thead>\n                <tr>\n                    <th>Date</th>\n                    <th>Heure</th>\n                    <th>Matière</th>\n                    <th>Justifier</th>\n                    <th>Actions</th>\n                </tr>\n                </thead><tbody>"),jQuery.each(e,function(e,a){let n="<tr>\n                        <td>"+a.date+"</td>\n                        <td>"+a.heure+"</td>\n                        <td>"+a.matiere+'</td>\n                        <td><input type="radio" value="true" data-absence="'+a.id+'" name="radio_'+a.id+'" class="justifieAbsence"';!0===a.justifie&&(n+=" checked "),n=n+'> Oui | <input type="radio" value="false" data-absence="'+a.id+'" name="radio_'+a.id+'" class="justifieAbsence"',!1===a.justifie&&(n+=" checked "),n+='> Non</td>\n                        <td><a href="" class="btn btn-danger supprimer"><i class="ti-close"></i></a></td>\n                    </tr>',t.append(n)}),t.append("</tbody>"),t.dataTable({language:langueFr})}})}),$(document).on("click",".justifieAbsence",function(){console.log($(this).val()),$.ajax({type:"GET",url:Routing.generate("administration_absences_justifie",{absence:$(this).data("absence"),etat:$(this).val()}),error:function(){addCallout("Erreur lors de l'enregistrement.","danger")},success:function(e){!0===e?addCallout("Absence justifiée avec succés !","success"):addCallout("Absence non justifiée avec succés !","warning")}})}),$(document).on("click",".absChangeTypeGroupe",function(e){e.preventDefault(),e.stopPropagation(),$(".absChangeTypeGroupe").removeClass("btn-primary"),$(this).addClass("btn-primary"),$("#listeEtudiantsAbsences").load(Routing.generate("api_absence_liste_etudiant",{typegroupe:$(this).data("typegroupe")}));let t=$("#absence-date"),a=$("#absence-heure");updateAffichage(t.val(),a.val())}),$(document).on("change","#absence-matiere",function(){let e=$(".etudiant"),t=$("#absence-date"),a=$("#absence-heure");e.removeClass("absent"),updateAffichage(t.val(),a.val())}),$(document).on("change","#absence-date",function(){let e=$(".etudiant"),t=$("#absence-date"),a=$("#absence-heure");e.removeClass("absent"),updateAffichage(t.val(),a.val())}),$(document).on("change","#absence-heure",function(){const e=$(".etudiant"),t=$("#absence-date"),a=$("#absence-heure");e.removeClass("absent"),updateAffichage(t.val(),a.val())}),$(document).on("click",".etudiant",function(){const e=$(this).attr("id").split("_");$(this).hasClass("absent")?($(this).removeClass("absent"),$.ajax({type:"POST",url:Routing.generate("application_personnel_absence_saisie_ajax",{matiere:$("#absence-matiere").val(),etudiant:e[1]}),dataType:"json",data:{date:$("#absence-date").val(),heure:$("#absence-heure").val(),action:"suppr"},error:function(){addCallout("Le délai pour l'enregistrement est dépassé. Contactez le responsable de la departement","danger")},success:function(e){n=e,addCallout("La suppression a été effectuée avec succés !","success")}})):($(this).addClass("absent"),$.ajax({type:"POST",url:Routing.generate("application_personnel_absence_saisie_ajax",{matiere:$("#absence-matiere").val(),etudiant:e[1]}),dataType:"json",data:{date:$("#absence-date").val(),heure:$("#absence-heure").val(),action:"saisie"},error:function(e){"out"===e.responseText?addCallout("Le délai pour l'enregistrement est dépassé. Contactez le responsable de la departement","danger"):addCallout("Erreur lors de l'enregistrement.","danger")},success:function(e){n=e,console.log("ajout"),console.log(n),addCallout("Absence enregistrée avec succés !","success")}}))}),$("#liste-absences").dataTable({language:langueFr,fnRowCallback:function(e,t,a,n){"non"===t[6]||"no"===t[6]||"No"===t[6]||"Non"===t[6]?$("td",e).css("background-color","#fce3e3"):$("td",e).css("background-color","#e3fcf2")}}),$(document).on("click",".justificatif-accepte",function(e){const t=$(this).data("justificatif");$.ajax({url:Routing.generate("administration_absence_justificatif_change_etat",{uuid:t,etat:"A"}),success:function(e){const a=$(".bx_"+t),n=a.parent();a.remove();let i='<a href="#" class="btn btn-success btn-outline"><i class="ti-check"></i>Accepté</a>';i=i+'<button data-justificatif="'+t+'"\nclass="btn btn-danger btn-outline btn-square justificatif-annuler bx_'+t+'" data-provide="tooltip" data-placement="bottom"\ntitle="Annuler"><i\nclass="material-icons">undo</i></button>',n.prepend(i),addCallout("Justificatif d'absence validé !","success")},error:function(e){addCallout("Une erreur est survenue !","danger")}})}),$(document).on("click",".justificatif-refuse",function(e){const t=$(this).data("justificatif");$.ajax({url:Routing.generate("administration_absence_justificatif_change_etat",{uuid:t,etat:"R"}),success:function(e){const a=$(".bx_"+t),n=a.parent();a.remove();let i='<a href="#" class="btn btn-warning btn-outline"><i class="ti-check"></i>Refusé</a>';i=i+'<button data-justificatif="'+t+'"\nclass="btn btn-danger btn-outline btn-square justificatif-annuler bx_'+t+'" data-provide="tooltip" data-placement="bottom"\ntitle="Annuler"><i\nclass="material-icons">undo</i></button>',n.prepend(i),addCallout("Justificatif d'absence refusé !","success")},error:function(){addCallout("Une erreur est survenue !","danger")}})}),$(document).on("click",".justificatif-annuler",function(e){const t=$(this).data("justificatif");$.ajax({url:Routing.generate("administration_absence_justificatif_change_etat",{uuid:t,etat:"D"}),success:function(e){const a=$(".bx_"+t),n=a.parent();a.remove();const i='<a href="#"\n                               class="btn btn-success btn-outline btn-square justificatif-accepte bx_'+t+'" data-provide="tooltip"\n                               data-justificatif="'+t+'"\n                               data-placement="bottom" title="atitle.accepter.le.justificatif"><i\n                                        class="ti-check"></i></a>\n                            <a href="#"\n                               class="btn btn-warning btn-outline btn-square justificatif-refuse bx_'+t+'" data-provide="tooltip"\n                               data-justificatif="'+t+'"\n                               data-placement="bottom" title="atitle.refuser.le.justificatif"><i\n                                        class="ti-na"></i></a>\n\n                            <a href="'+Routing.generate("administration_absence_justificatif_delete",{id:t})+'" data-csrf="{{ csrf_token(\'delete\' ~ justificatif.uuidString) }}"\n                               class="btn btn-danger btn-outline btn-square supprimer bx_'+t+'"><i\n                                        class="ti-close" data-provide="tooltip" data-placement="bottom"\n                                        title="atitle.supprimer"></i></a>';n.prepend(i),addCallout("Etat du justificatif d'absence annulé !","success")},error:function(e){addCallout("Une erreur est survenue !","danger")}})}),$(".savegroupe").click(function(){const e=$(this).attr("id"),t={notes:[]};$(".noteetudiant:input").each(function(){if($(this).hasClass(e)){const e=$(this).data("etudiant"),a={id:e,note:$(this).val(),absence:$("#abs_"+e).prop("checked"),commentaire:$("#com_"+e).val()};t.notes.push(a)}}),$.ajax({url:Routing.generate("application_personnel_note_ajax_saisie",{uuid:$(this).data("evaluation")}),type:"POST",data:{notes:t},success:function(e){addCallout("Les notes de <strong>ce groupe</strong> ont été enregistrées avec succés ! Vous pouvez les modifier !","success")},error:function(){addCallout("Une erreur est survenue pendant l'envoi... <br>Veuillez réessayer","danger")}})}),$(document).on("keyup",".noteetudiant",function(e){const t=$(this).val();console.log(t),"-0.01"===t?$(this).removeClass("is-invalid").removeClass("is-valid"):parseFloat(t)>=0&&parseFloat(t)<=20?$(this).removeClass("is-invalid").addClass("is-valid"):$(this).removeClass("is-valid").addClass("is-invalid")}),$(document).on("click",".articleLike",function(e){e.preventDefault(),e.stopPropagation();const t=$(this);$.ajax({url:Routing.generate("information_like",{slug:$(this).data("article")}),success:function(e){console.log(t.first()),t.children().hasClass("text-success")?t.html('<i class="ti-heart text-danger fs-11"></i> '+e):t.html('<i class="ti-heart text-success fs-11"></i> '+e)}})}),$(document).on("keyup","#search",function(e){const t=$(this).val();console.log(t);const a=$("#search_reponse_etudiant"),n=$("#search_reponse_personnel"),i=$("#search_reponse_autre");if(t.length>2)$.ajax({url:Routing.generate("recherche",{keyword:t}),dataType:"json",success:function(e){let o="";e.etudiants.length>0?jQuery.each(e.etudiants,function(e,t){o=o+'<a class="media" href="'+Routing.generate("user_profil",{type:"etudiant",slug:t.slug})+'" target="_blank">\n                <span class="avatar status-dark">\n                  <img src="/upload/etudiants/'+t.photo+'" alt="Photo de profil de '+t.displayPr+'">\n                </span>\n\n                        <div class="media-body">\n                            <p><strong>'+t.displayPr+'</strong>\n                                <time class="float-right">'+t.groupes+"</time>\n                            </p>\n                        </div>\n                    </a>"}):o='<div class="alert alert-warning">Pas de résultat pour votre rehcerche <strong>"'+t+'"</strong></div>',a.slideUp().empty().append(o).slideDown(),o="",e.personnels.length>0?jQuery.each(e.personnels,function(e,t){o=o+'<a class="media items-center" href="'+Routing.generate("user_profil",{type:"personnel",slug:t.slug})+'" target="_blank">\n                        <img class="avatar avatar-sm" src="upload/personnels/'+t.photo+'" alt="Photo de profil de '+t.displayPr+'">\n                        <p>'+t.displayPr+"</p>\n                    </a>"}):o='<div class="alert alert-warning">Pas de résultat pour votre rehcerche <strong>"'+t+'"</strong></div>',n.slideUp().empty().append(o).slideDown(),o="",e.autres.length>0?jQuery.each(e.autres,function(e,t){o=o+'<a class="media items-center" href="">\n                        <img class="avatar avatar-sm" src="../assets/img/avatar/1.jpg" alt="...">\n                        <p>'+t+"</p>\n                    </a>"}):o='<div class="alert alert-warning">Pas de résultat pour votre rehcerche <strong>"'+t+'"</strong></div>',i.slideUp().empty().append(o).slideDown()}});else{var o='<div class="alert alert-info">Saisir au moins 3 caractères</div>';i.slideUp().empty().append(o).slideDown(),n.slideUp().empty().append(o).slideDown(),a.slideUp().empty().append(o).slideDown()}}),$(document).on("click",".rattrapage-accepte",function(e){e.preventDefault();const t=$(this).data("rattrapage");$.ajax({url:Routing.generate("administration_rattrapage_change_etat",{uuid:t,etat:"A"}),success:function(){const e=$(".bx_"+t),a=e.parent();e.remove(),a.prepend('<a href="#" class="btn btn-success btn-outline"><i class="ti-check"></i>Acceptée</a>'),addCallout("Demande de rattrapage validée !","success")},error:function(){addCallout("Une erreur est survenue !","danger")}})}),$(document).on("click",".rattrapage-refuse",function(e){e.preventDefault();const t=$(this).data("rattrapage");$.ajax({url:Routing.generate("administration_rattrapage_change_etat",{uuid:t,etat:"R"}),success:function(){const e=$(".bx_"+t),a=e.parent();e.remove(),a.prepend('<a href="#" class="btn btn-warning btn-outline"><i class="ti-na"></i>Refusée</a>'),addCallout("Demande de rattrapage refusée !","success")},error:function(){addCallout("Une erreur est survenue !","danger")}})}),$(document).on("change",".dateChange",function(){const e=$(this).data("rattrapage");$.ajax({url:Routing.generate("administration_rattrapage_planning_change",{uuid:e,type:"date"}),data:{data:$(this).val()},method:"POST",error:function(){addCallout("Une erreur est survenue !","danger")}})}),$(document).on("blur",".salleChange",function(){const e=$(this).data("rattrapage");$.ajax({url:Routing.generate("administration_rattrapage_planning_change",{uuid:e,type:"salle",data:$(this).val()}),error:function(e){addCallout("Une erreur est survenue !","danger")}})}),$(document).on("blur",".heureChange",function(){const e=$(this).data("rattrapage");$.ajax({url:Routing.generate("administration_rattrapage_planning_change",{uuid:e,type:"heure",data:$(this).val()}),error:function(){addCallout("Une erreur est survenue !","danger")}})}),$(document).on("click","#sallePartout",function(){const e=$("#salle").val();$.ajax({url:Routing.generate("administration_rattrapage_update_global",{type:"salle",diplome:diplome}),data:{valeur:e},method:"POST",success:function(){$(".salleChange").each(function(){$(this).val(e)})}})}),$(document).on("click","#datePartout",function(e){e.preventDefault();const t=$("#date").val();$.ajax({url:Routing.generate("administration_rattrapage_update_global",{type:"date",diplome:diplome}),data:{valeur:t},method:"POST",success:function(){$(".dateChange").each(function(){$(this).val(t)})}})}),$(document).on("click","#heurePartout",function(e){e.preventDefault();const t=$("#heure").val();$.ajax({url:Routing.generate("administration_rattrapage_update_global",{type:"heure",diplome:diplome}),data:{valeur:t},method:"POST",success:function(){$(".heureChange").each(function(){$(this).val(t)})}})}),$(document).on("click",".optAfficher",function(){const e=$(this).data("id"),t=$(this).children("i"),a=$(this);$.ajax({url:Routing.generate("administration_evaluation_visibilite",{uuid:e}),success:function(){t.hasClass("fa-eye")?(a.addClass("btn-danger"),a.removeClass("btn-info").removeClass("btn-outline"),t.removeClass("fa-eye"),t.addClass("fa-eye-slash"),a.attr("title","Evaluation masquée. Rendre visible l'évaluation")):(a.removeClass("btn-danger"),a.addClass("btn-info").addClass("btn-outline"),t.removeClass("fa-eye-slash"),t.addClass("fa-eye"),a.attr("title","Evaluation visible. Masquer l'évaluation")),addCallout("Visibilité de l'évaluation modifiée !","success")},error:function(){addCallout("Une erreur est survenue !","danger")}})}),$(document).on("click",".optVerrouiller",function(){const e=$(this).data("id"),t=$(this).children("i"),a=$(this);$.ajax({url:Routing.generate("administration_evaluation_modifiable",{uuid:e}),success:function(){$(this).children("i").hasClass("fa-pencil")?(a.addClass("btn-danger"),a.removeClass("btn-warning").removeClass("btn-outline"),t.children("i").removeClass("fa-pencil"),t.children("i").addClass("fa-lock"),a.attr("data-original-title","Modification interdite. Autoriser la modificaiton")):(a.removeClass("btn-danger"),a.addClass("btn-warning").addClass("btn-outline"),t.children("i").removeClass("fa-lock"),t.addClass("fa-pencil"),a.attr("data-original-title","Modification autorisée. Interdire la modification")),addCallout("Vérouillage de l'évaluation modifiée !","success")},error:function(){addCallout("Une erreur est survenue !","danger")}})}),$(document).on("click",".filtreTypeDate",function(e){const t=$(this),a=t.data("type");t.hasClass("btn-outline")?(!function(e){$(".event").each(function(t){$(this).data("type-event")===e&&$(this).show()})}(a),t.removeClass("btn-outline")):(t.addClass("btn-outline"),function(e){$(".event").each(function(t){$(this).data("type-event")===e&&$(this).hide()})}(a))}),$(document).on("click",".filtreUtilisateurDate",function(e){const t=$(this),a=t.data("type");t.hasClass("btn-outline")?(!function(e){"E"===e?$(".event").each(function(t){$(this).data("qui-event")===e&&$(this).show()}):$(".event").each(function(t){$(this).hasClass(e)&&$(this).show()})}(a),t.removeClass("btn-outline")):(t.addClass("btn-outline"),function(e){"E"===e?$(".event").each(function(t){$(this).data("qui-event")===e&&$(this).hide()}):$(".event").each(function(t){$(this).hasClass(e)&&$(this).hide()})}(a))}),$(document).on("change","#semaine",function(e){e.preventDefault();let t=$(this).val().split("_");console.log(t),location.href=Routing.generate("agenda_index",{semaine:t[2],valeur:t[1],filtre:t[0]})}),$(document).on("change",".departementParDefaut",function(e){$.ajax({url:Routing.generate("user_change_departement_defaut",{departement:$(this).val()}),method:"POST",success:function(e){addCallout("Mofification enregistrée !","success")},error:function(e){addCallout("Erreur lors de la sauvegarde de la modification !","danger")}})}),$(document).on("change","#chgt_etudiant_semestre",function(){$.ajax({url:Routing.generate("user_change_semestre",{etudiant:$(this).data("etudiant"),semestre:$(this).val()}),method:"POST",success:function(e){$("#liste_groupes").empty().append('<tr><td colspan="3">Aucun groupe</td></tr>'),addCallout("Mofification enregistrée !","success")},error:function(e){addCallout("Erreur lors de la sauvegarde de la modification !","danger")}})}),$(document).on("change","#chgt_etudiant_departement",function(){$.ajax({url:Routing.generate("user_change_departement",{etudiant:$(this).data("etudiant"),departement:$(this).val()}),method:"POST",success:function(e){$("#liste_groupes").empty().append('<tr><td colspan="3">Aucun groupe</td></tr>'),addCallout("Mofification enregistrée !","success")},error:function(e){addCallout("Erreur lors de la sauvegarde de la modification !","danger")}})}),$(document).on("change","#chgt_etudiant_fin",function(){$.ajax({url:Routing.generate("user_change_annee_sortie",{etudiant:$(this).data("etudiant"),annee:$(this).val()}),method:"POST",success:function(e){addCallout("Mofification enregistrée !","success")},error:function(e){addCallout("Erreur lors de la sauvegarde de la modification !","danger")}})}),$("#matiere_semestre").change(function(){const e=$(this);$.ajax({url:Routing.generate("api_liste_ue_by_semestre"),dataType:"JSON",type:"POST",data:{semestreid:e.val()},success:function(t){const a=$("#matiere_ue");a.html(""),a.append("<option value> Choisir une UE dans le semestre "+e.find("option:selected").text()+" ...</option>"),$.each(t,function(e,t){a.append('<option value="'+t.id+'">'+t.numeroUe+" "+t.libelle+"</option>")})},error:function(e){alert("An error ocurred while loading data ...")}}),$.ajax({url:Routing.generate("api_liste_parcour_by_semestre"),dataType:"JSON",type:"POST",data:{semestreid:e.val()},success:function(t){const a=$("#matiere_parcours");a.html(""),a.append("<option value> Choisir (optionnel) un parcour pour le semestre "+e.find("option:selected").text()+" ...</option>"),$.each(t,function(e,t){a.append('<option value="'+t.id+'">'+t.libelle+"</option>")})},error:function(e){alert("An error ocurred while loading data ...")}}),$.ajax({url:Routing.generate("api_matieres_semestre",{semestre:e.val()}),dataType:"JSON",type:"GET",success:function(e){const t=$("#matiere_matiereParent");t.html(""),t.append("<option value> Choisir (optionnel) une matière parent pour "+$("#matiere_libelle").val()+" ...</option>"),$.each(e,function(e,a){t.append('<option value="'+a.id+'">'+a.display+"</option>")})},error:function(e){alert("An error ocurred while loading data ...")}})}),$(document).on("click",".change-diplome",function(e){e.preventDefault(),$(".change-diplome").removeClass("active show"),$(this).addClass("active show"),$.ajax({url:Routing.generate("administration_matiere_diplome",{diplome:$(this).data("diplome")}),dataType:"HTML",type:"GET",success:function(e){$("#content_diplome").slideUp().empty().append(e).slideDown(),$(".datatable_matieres").dataTable({language:langueFr})}})}),$(document).on("change",".tuteurUniversitaireAlternance",function(){$.ajax({url:Routing.generate("administration_alternance_update_tuteur_universitaire",{alternance:$(this).data("alternance"),personnel:$(this).val()}),success:function(){addCallout("Tuteur universitaire enregistré !","success")},error:function(){addCallout("Une erreur est survenue !","danger")}})}),$(document).on("click",".initAllAlternance",function(e){e.preventDefault();const t=$(this).attr("href");swal({title:"Etes vous sûr?",text:"Vous allez initialiser tous les suivis d'alternances. Cela effacera les données déjà présente. !",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Oui, initialiser!",cancelButtonText:"Non, ne rien faire!",confirmButtonClass:"btn btn-primary",cancelButtonClass:"btn btn-secondary",buttonsStyling:!1}).then(function(e){e.value?$.ajax({url:t,type:"POST",success:function(){addCallout("Initialisation effectuée avec succès","success"),swal("Initialisé!","Toutes les fiches des alertnants ont été initialisées.","success")},error:function(){swal("Error deleting!","Please try again","error"),addCallout("Erreur lors de la tentative d'initialisation","danger")}}):"cancel"===e.dismiss&&swal("Cancelled","Your imaginary file is safe :)","error")})}),$(document).on("keyup","#etudiant",function(){const e=$(this).val();console.log(e),e.length>2&&$("#resultat").empty().load(Routing.generate("sa_scolarite_recherche",{needle:e}))}),$(document).on("change","#scolarite_semestre",function(){$.ajax({url:Routing.generate("administration_scolarite_ues_semestre",{semestre:$(this).val()}),type:"POST",success:function(e){var t='<div class="row" id="blocUEs"><div class="col-sm-1">&nbsp;</div><div class="col-sm-11">';for(var a in e){t=t+'<div class="form-group"><label for="ue_'+a+'" class="required">UE '+e[a]+'</label><input type="text" id="ue_'+a+'" name="ue_'+a+'" required="required" class="form-control" value="0"></div>'}t+="</div></div>";var n=$("#scolarite_semestre");document.getElementById("blocUEs")&&$("#blocUEs").remove(),n.after(t)},error:function(){addCallout("Erreur la requête.","error")}})}),$(document).on("click",".visibiliteBorne",function(){const e=$(this);$.ajax({url:Routing.generate("administration_borne_visibilite",{id:e.data("id")}),success:function(t){!1===t?(addCallout("Message masqué avec succés !","success"),e.removeClass("btn-success").addClass("btn-danger"),e.children("i").removeClass("fa-eye").addClass("fa-eye-slash"),e.attr("title","Message masqué. Rendre visible")):(addCallout("Message affiché avec succés !","success"),e.removeClass("btn-danger").addClass("btn-success"),e.children("i").removeClass("fa-eye-slash").addClass("fa-eye"),e.attr("title","Message affiché. Rendre invisible"))}})}),$(document).on("change",".typegroupe_defaut",function(e){$.ajax({url:Routing.generate("administration_type_groupe_defaut"),method:"POST",data:{typegroupe:$(this).val()},success:function(){addCallout("Type de groupe par défaut enregistré","success")},error:function(){addCallout("Erreur lors de l'enregistrement du type de groupe par défaut","danger")}})}),$(document).on("click",".add_groupe",function(){const e=$(this).data("parent");$.ajax({url:Routing.generate("administration_groupe_new"),method:"POST",data:{libelle:$("#groupe_libelle_"+e).val(),ordre:$("#groupe_ordre_"+e).val(),code:$("#groupe_code_apogee_"+e).val(),type:$("#groupe_type_groupe_"+e).val(),parcours:$("#groupe_parcours_"+e).val(),parent:e},success:function(){$("#groupe_bloc").empty().load(Routing.generate("administration_groupe_refresh",{parent:e})),addCallout("Groupe ajouté","success")},error:function(){addCallout("Erreur lors de l'ajout du groupe","danger")}})}),$(document).on("click","#btn_creneau_add",function(){const e=$("#change_annee_universitiare_temp").val();$.ajax({method:"POST",data:{anneeUniversitaire:e,jour:$("#creneau_jour").val(),debut:$("#creneau_debut").val(),fin:$("#creneau_fin").val()},url:Routing.generate("administration_creneau_cours_new"),success:function(){$("#liste_creneaux").empty().load(Routing.generate("administration_creneau_cours_liste",{annee_universitaire:e})),addCallout("Créneau ajouté avec succès","success")},error:function(){addCallout("Erreur lors de l'ajout du créneau","danger")}})}),$(document).on("click",".bloquercreneau",function(){const e=$(this);console.log("click"),e.hasClass("bloquercreneau_eviter")?(o("dispo",e.data("creneau"),e.data("semaine")),e.removeClass("bloquercreneau_eviter")):e.hasClass("bloquercreneau_interdit")?(e.removeClass("bloquercreneau_interdit"),e.addClass("bloquercreneau_eviter"),o("au",e.data("creneau"),e.data("semaine"))):(e.addClass("bloquercreneau_interdit"),o("va",e.data("creneau"),e.data("semaine")))}),$(document).on("click",".creneau",function(){const e=$("#nb_interdit"),t=$("#nb_eviter"),a=$("#nb_dispo"),n=$(this).data("heure"),o=$(this).dataAttr("jour");let s=parseInt(e.text()),r=parseInt(t.text()),l=parseInt(a.text());$(this).hasClass("bloquercreneau_interdit")?($(this).removeClass("bloquercreneau_interdit"),$(this).addClass("bloquercreneau_eviter"),s--,r++,i(o,n,"E")):$(this).hasClass("bloquercreneau_eviter")?($(this).removeClass("bloquercreneau_eviter"),r--,l++,i(o,n,"D")):($(this).addClass("bloquercreneau_interdit"),s++,l--,i(o,n,"I")),e.text(s),t.text(r),a.text(l)}),$(document).on("change",".updateProgression",function(){var e,t,a,n;console.log("update"),e=$(this).data("semaine"),t=$(this).data("type"),a=$(this).data("matiere"),n=$(this).val(),$.ajax({url:Routing.generate("application_personnel_progression_update",{matiere:a}),data:{semaine:e,typecours:t,nbSeances:n},method:"POST"}),function(e,t,a){const n=parseInt($("#nbgr_cm_"+a).text()),i=parseInt($("#nbgr_td_"+a).text()),o=parseInt($("#nbgr_tp_"+a).text()),s="tot_s"+e+"_"+a;let r=parseInt($("#"+s+"_cm").val());isNaN(r)&&(r=0);let l=parseInt($("#"+s+"_td").val());isNaN(l)&&(l=0);let c=parseInt($("#"+s+"_tp").val());isNaN(c)&&(c=0);const u=r*n*1.5+l*i*1.5+c*o*1.5;$("#"+s).text(u);const d="tot_cm_"+a,p="tot_td_"+a,m="tot_tp_"+a,g="tot_cm_seance_"+a,h="tot_td_seance_"+a,f="tot_tp_seance_"+a,_="tot_"+a,v="tot_seance_"+a,b="tot_cm_h_"+a,y="tot_td_h_"+a,C="tot_tp_h_"+a,x="tot_h_"+a;let j=0,k=0,q=0;$(".cm_"+a).each(function(){let e=parseInt($(this).val());isNaN(e)&&(e=0),j+=e}),console.log(j),$("#"+g).text(j),$("#"+d).text(j*n),$("#"+b).text(1.5*j*n),$(".td_"+a).each(function(){let e=parseInt($(this).val());isNaN(e)&&(e=0),k+=e}),$("#"+h).text(k),$("#"+p).text(k*i),$("#"+y).text(1.5*k*i),$(".tp_"+a).each(function(){let e=parseInt($(this).val());isNaN(e)&&(e=0),q+=e}),$("#"+f).text(q),$("#"+m).text(q*o),$("#"+C).text(1.5*q*o),$("#"+v).text(j+k+q),$("#"+_).text(j*n+k*i+q*o),$("#"+x).text(1.5*j*n+1.5*k*i+1.5*q*o)}($(this).data("semaine"),$(this).data("type"),$(this).data("matiere"))}),$(document).on("click","#refresh",function(){!function(){const e=Array();for(var t=1;t<15;t++)e[t]=0;e.total=0,e.total_groupe=0,e.total_heure=0,$(".une_matiere").each(function(){const t=$(this).data("matiere"),a=parseInt($("#nbgr_cm_"+t).text()),n=parseInt($("#nbgr_td_"+t).text()),i=parseInt($("#nbgr_tp_"+t).text());let o=0,s=0,r=0;for(let l=1;l<15;l++){const c="tot_s"+l+"_"+t;let u=parseInt($("#"+c+"_cm").val());isNaN(u)&&(u=0),o+=u;let d=parseInt($("#"+c+"_td").val());isNaN(d)&&(d=0),s+=d;let p=parseInt($("#"+c+"_tp").val());isNaN(p)&&(p=0),r+=p;const m=u*a*1.5+d*n*1.5+p*i*1.5;$("#"+c).text(m),e[l]+=m}const l="tot_cm_"+t,c="tot_td_"+t,u="tot_tp_"+t,d="tot_cm_seance_"+t,p="tot_td_seance_"+t,m="tot_tp_seance_"+t,g="tot_"+t,h="tot_seance_"+t,f="tot_cm_h_"+t,_="tot_td_h_"+t,v="tot_tp_h_"+t,b="tot_h_"+t;$("#"+d).text(o),$("#"+l).text(o*a),$("#"+f).text(1.5*o*a),$("#"+p).text(s),$("#"+c).text(s*n),$("#"+_).text(1.5*s*n),$("#"+m).text(r),$("#"+u).text(r*i),$("#"+v).text(1.5*r*i),$("#"+h).text(o+s+r),$("#"+g).text(o*a+s*n+r*i),$("#"+b).text(1.5*o*a+1.5*s*n+1.5*r*i),e.total+=o+s+r,e.total_groupe+=o*a+s*n+r*i,e.total_heure+=1.5*o*a+1.5*s*n+1.5*r*i});for(var t=1;t<15;t++)$("#tot_s"+t).text(e[t]);$("#tot_seance").text(e.total),$("#tot_global_groupe").text(e.total_groupe),$("#tot_global_heure").text(e.total_heure)}()});let s=[],r=0;function l(e){let t='<div class="form-group">';return t=(t=t+'<label for="question_qcu['+e+']" class="required">Libellé réponse '+e+"</label>")+'<input type="text" id="question_qcu['+e+']" name="question_qcu['+e+']" required="required" class="form-control">',t+="</div>",t=(t=(t+='<div class="form-group">')+'<label for="question_qcu_valeur['+e+']" class="required">Valeur pour la réponse '+e+"</label>")+'<input type="text" id="question_qcu_valeur['+e+']" name="question_qcu_valeur['+e+']" required="required" class="form-control">',t+="</div>"}function c(e){let t='<div class="form-group">';return t=(t=t+'<label for="question_qcm['+e+']" class="required">Libellé réponse '+e+"</label>")+'<input type="text" id="question_qcm['+e+']" name="question_qcm['+e+']" required="required" class="form-control">',t+="</div>",t=(t=(t+='<div class="form-group">')+'<label for="question_qcm_valeur['+e+']" class="required">Valeur pour la réponse '+e+"</label>")+'<input type="text" id="question_qcm_valeur['+e+']" name="question_qcm_valeur['+e+']" required="required" class="form-control">',t+="</div>"}$("#selectable").selectable({filter:"th,td:not(.edt_cours)",start:function(e,t){$(e.originalEvent.target).hasClass("edt_cours")||(s=[],r=0)},stop:function(e,t){var a;$(e.originalEvent.target).hasClass("edt_cours")?(a=$(e.originalEvent.target).data("edt"),$.ajax({url:Routing.generate("administration_edt_get_event",{id:a}),success:function(e){$("#hdbt").selectpicker("val",e.heureDbtInt),$("#hfin").selectpicker("val",e.heureFinInt),$("#jourc"+e.jour).prop("checked",!0),$("#typecours").selectpicker("val",e.typecours+"-"+e.groupe),$("#salle").selectpicker("val",e.salle),$("#texte").val(e.texte),$("#selectmatiere").selectpicker("val",e.matiereId),$("#selectenseignant").selectpicker("val",e.personnelId),$("#idEdtUpdate").val(e.id),$("#btnAddEDT").empty().append("Modifier le créneau"),$("#blocadd").show()}}),console.log("modif"+a)):function(){let e,t=s[0].split("_");$("#hdbt").selectpicker("val",t[1]);let a=s[s.length-1].split("_"),n=parseInt(a[1])+1;$("#hfin").selectpicker("val",n),$("#jourc"+t[2]).prop("checked",!0);let i=parseInt(a[3])-parseInt(t[3]);e=0===i?"TP-"+t[3]:1===i?"TD-"+t[3]:"CM-1",$("#typecours").selectpicker("val",e),$("#salle").selectpicker("val",""),$("#texte").selectpicker("val",""),$("#idEdtUpdate").val(""),$("#btnAddEDT").empty().append("Ajouter le créneau"),$("#blocadd").show()}()},selected:function(e,t){$(this).find(".ui-selected");s[r]=$(t.selected).attr("id"),r+=1}}),$("#foc").scroll(),$(document).on("click","#idimportsemaine",function(){console.log("ok");const e=$("#zoneaction");e.empty(),e.load(Routing.generate("administration_edt_za_importsemaine")),e.fadeIn(1e3)}),$("#idcreerzone").click(function(){const e=$("#zoneaction");e.empty(),e.fadeIn(1e3)}),$("#idexport").click(function(){const e=$("#zoneaction");e.empty(),e.fadeIn(1e3),$("#load-page").hide()}),$("#ideffacer").click(function(){const e=$("#zoneaction");e.empty(),e.fadeIn(1e3),$("#load-page").hide()}),$(document).on("click",".closeza",function(e){e.preventDefault();const t=$("#zoneaction");t.fadeOut(1e3),t.empty(),t.hide()}),$(document).on("change","#hdbt",function(){const e=parseInt($(this).val())+3;$("#hfin").val(e)}),$(document).on("change","#afficheenseignant",function(){const e=$("#zone_edt");$("#semainereelle").val();e.empty(),e.fadeIn(2e3),$("#load-page").hide()}),$(document).on("change","#affichesalle",function(){const e=$("#zone_edt");$("#semainereelle").val();e.empty().hide(),e.fadeIn(2e3),$("#load-page").hide()}),$(document).on("change","#affichejour",function(){const e=$("#zone_edt");$("#semainereelle").val();e.empty(),e.fadeIn(2e3),$("#load-page").hide()}),$(document).on("change","#affichesemaine",function(){$("#zone_edt").empty();$(this).val().split("_");$("#load-page").hide()}),$(document).on("change","#affichemodule",function(){const e=$("#zone_edt");$("#semainereelle").val();e.empty(),e.fadeIn(2e3),$("#load-page").hide()}),$(document).on("change","#selectpersonnel",function(){const e=$("#selectsemestre"),t=$("#selectmatiere");e.val("0"),t.selectpicker("destroy"),t.empty(),t.append(new Option("Choisissez un semestre !","0")),t.selectpicker("val","0")}),$(document).on("change","#edtSelectSemestre",function(){$.ajax({url:Routing.generate("api_matieres_semestre_personnel",{semestre:$(this).val(),personnel:$("#selectpersonnel").val()}),type:"POST",dataType:"json",success:function(e){const t=$("#selectmatiere");t.selectpicker("destroy"),t.empty(),t.append(new Option("Choisissez une matière !",""));for(let a in e){let n=e[a];console.log(a),console.log(n),t.append(new Option(n.libelle+" (UE: "+n.ue+")",n.id))}t.selectpicker()},error:function(){}})}),$(document).on("click","#btnafficheRealise",function(e){e.preventDefault();const t=$("#blocchrono");t.empty(),t.load(Routing.generate("administration_edt_service_realise_affiche",{semestre:$("#edtSelectSemestre").val(),personnel:$("#selectpersonnel").val(),matiere:$("#selectmatiere").val()}))}),$(document).on("click","#addCategorie",function(){if($("#listeCategories").hasDataAttr("data-checkbox")){const e=$("#listeCategories").DataTable();e.clear(),e.destroy()}$.ajax({url:Routing.generate("administration_article_categorie_add"),data:{libelle:$("#libelle").val()},method:"POST",success:function(e){const t=$("#listeCategories").empty();t.append("<thead>\n<tr>\n<th>Libellé</th>\n<th>Nb Article</th>\n<th>Actions</th>\n</tr>\n</thead><tbody>"),jQuery.each(e,function(e,a){const n="<tr>\n                        <td>"+a.libelle+"</td>\n                        <td>"+a.nbArticles+'</td>\n                        <td><a href="\n                               data-csrf=""\n                               class="btn btn-danger btn-outline btn-square supprimer"\n                               data-provide="tooltip"\n                               data-placement="bottom"\n                               title="Supprimer la catégorie">\n                                <i class="'+iconDelete+'"></i>\n                                <span class="sr-only">Supprimer la catégorie</span>\n                            </a></td>\n                    </tr>';t.append(n)}),t.append("</tbody>"),t.append('<tfoot>\n                <tr>\n                    <td><label for="libelle" class="sr-only">Libelle</label>\n                        <input type="text" placeholder="Libellé de la catégorie" id="libelle" class="form-control"></td>\n                    <td>&nbsp;</td>\n                    <td>\n                        <button class="btn btn-success btn-block" id="addCategorie">Ajouter catégorie</button>\n                    </td>\n                </tr>\n                </tfoot>'),t.dataTable({language:langueFr})}})}),$(document).on("change",".changetuteur",function(){$.ajax({url:Routing.generate("administration_stage_etudiant_change_tuteur",{stageEtudiant:$(this).data("stage"),tuteur:$(this).val()}),success:function(){addCallout("Tuteur universitaire modifié !","success")}})}),$(document).on("click",".enregistreModeleMail",function(){const e=$(this).data("type");console.log(e),console.log(ed2.getContents()),$.ajax({url:Routing.generate("administration_stage_periode_courrier_sauvegarde_modele",{uuid:$(this).data("periode"),mail:e}),data:{message:ed2.root.innerHTML,sujet:$("#sujet_"+e).val()},success:function(){addCallout("Modèle enregistré !","success")}})}),$(document).on("change",'input[type=radio][name="quizz_question[type]"]',function(){let e=$('input[type=radio][name="quizz_question[type]"]:checked').val(),t=$("#reponses"),a="";"qcu"===e?(a+=l(1),a+='<a href="#" id="addreponseqcu" class="btn btn-success" data-nb="1"><i class="fa fa-plus"></i>Ajouter une réponse</a>'):"qcm"===e?(a+=c(1),a+='<a href="#" id="addreponseqcm" class="btn btn-success" data-nb="1"><i class="fa fa-plus"></i>Ajouter une réponse</a>'):"yesno"===e?(a='<div class="form-group">',a+='<label for="question_yesno" class="required">Texte d\'aide pour la réponse Oui/Non</label>',a+='<input type="text" id="question_yesno" name="question_yesno" class="form-control">',a+="</div>",a+='<div class="form-group">',a+='<label for="question_libre_oui" class="required">Texte pour le "oui"</label>',a+='<input type="text" id="question_libre_oui" name="question_libre_oui" required="required" class="form-control" value="Oui">',a+="</div>",a+='<div class="form-group">',a+='<label for="question_libre_non" class="required">Texte pour le "non"</label>',a+='<input type="text" id="question_libre_non" name="question_libre_non" required="required" class="form-control" value="Non">',a+="</div>"):"echelle"===e?(a='<div class="form-group">',a+='<label for="question_min" class="required">Question à échelle. Indiquer la valeur minimale</label>',a+='<input type="text" id="question_min" name="question_min" required="required" class="form-control" value="1">',a+="</div>",a+='<div class="form-group">',a+='<label for="question_min_sens" class="required">Signification valeur minimale</label>',a+='<input type="text" id="question_min_sens" name="question_min_sens" required="required" class="form-control">',a+="</div>",a+='<div class="form-group">',a+='<label for="question_max" class="required">Question à échelle. Indiquer la valeur maximale</label>',a+='<input type="text" id="question_max" name="question_max" required="required" class="form-control" value="10">',a+="</div>",a+='<div class="form-group">',a+='<label for="question_max_sens" class="required">Signification valeur maximale</label>',a+='<input type="text" id="question_max_sens" name="question_max_sens" required="required" class="form-control">',a+="</div>"):"libre"===e?(a='<div class="form-group">',a+='<label for="question_libre">Texte d\'aide pour la réponse libre</label>',a+='<input type="text" id="question_libre" name="question_libre" class="form-control">',a+="</div>"):a='<div class="alert alert-info">Choisir d\'abord le type de question</div>',t.empty().append(a)}),$(document).on("click","#addreponseqcu",function(){let e=parseInt($(this).data("nb"))+1;$(this).before(l(e)),$(this).data("nb",e)}),$(document).on("click","#addreponseqcm",function(){let e=parseInt($(this).data("nb"))+1;$(this).before(c(e)),$(this).data("nb",e)}),$(document).on("change",".questionQualite",function(){console.log($(this)),$.ajax({url:Routing.generate("app_etudiant_qualite_ajax_reponse",{uuid:$("#questionnaire").val()}),method:"POST",data:{cleReponse:$(this).attr("id"),cleQuestion:$(this).attr("name")},success:function(){}})}),$(document).on("blur",".questionQualiteTextArea",function(){console.log($(this)),$.ajax({url:Routing.generate("app_etudiant_qualite_ajax_reponse_txt",{uuid:$("#questionnaire").val()}),method:"POST",data:{cleQuestion:$(this).attr("name"),value:$(this).val()},success:function(){}})}),$("#sortable").sortable({revert:!0}),$(".draggable").draggable({connectToSortable:"#sortable",helper:"clone",revert:"invalid"});const u=$(".preloader");if(u.length){const e=u.dataAttr("hide-spped",600);u.fadeOut(e)}$(document).on({ajaxStart:function(){u.show()},ajaxStop:function(){u.hide()}}),$(".callout").delay(5e3).slideUp("slow")});