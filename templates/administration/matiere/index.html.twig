{% extends 'base.html.twig' %}


{% block header %}
    {{ 'adm.matiere.index.heading'|trans }}
{% endblock %}

{% block headeractions %}

    <div class="header-action bg-white">
        <nav class="nav">
            {% for diplome in user_data.diplomes %}
                <a class="nav-link {% if loop.first %}active{% endif %}"
                   href="#dip_{{ diplome.id }}">{{ diplome.libelle }}</a>
            {% endfor %}
        </nav>

        <div class="buttons">

            <a href="{{ path('administration_index') }}" class="btn btn-primary btn-float" data-provide="tooltip"
               data-placement="bottom" title="{{ 'atitle.retour_administration'|trans }}"><i class="material-icons">build</i></a>
        </div>
    </div>
{% endblock %}

{% block content %}
    <div class="tab-content">
        {% for diplome in user_data.diplomes %}
            <div class="tab-pane {% if loop.first %}fade active show{% endif %}" id="dip_{{ diplome.id }}">
                <div class="card">
                    <header class="card-header">
                        <h4 class="card-title">{{ 'adm.matiere.index.heading'|trans }} | {{ diplome.libelle }}</h4>
                        <div class="card-header-actions" style="">
                            <span>
                                <a href="{{ path('administration_matiere_new',{diplome:diplome.id}) }}"
                                   class="btn btn-sm btn btn-info" title="{{ 'atitle.creer_nouveau'|trans }}"
                                   data-provide="tooltip"
                                   data-placement="bottom"><i class="ti-plus"></i></a>

                            </span>
                            <ul class="card-controls">
                                <li class="dropdown">{# todo: a gérer fonctiondes diplômes #}
                                    <a data-toggle="dropdown" href="#"><i class="ti-more-alt rotate-90"></i></a>
                                    <div class="dropdown-menu dropdown-menu-right">
                                        <a href="#" class="dropdown-item"><i class="fa fa-file-pdf-o"></i> PDF</a>
                                        <a href="#" class="dropdown-item"><i class="fa fa-file-excel-o"></i>
                                            Excel</a>
                                        <a href="#" class="dropdown-item"><i class="fa fa-file-text-o"></i> CSV</a>
                                    </div>
                                </li>
                            </ul>

                        </div>
                    </header>


                    <div class="card-body">
                        <ul class="nav nav-tabs">
                            {% for semestre in user_data.semestresByDiplome(diplome.id) %}
                                <li class="nav-item">
                                    <a class="nav-link {% if loop.first %} active{% endif %}" data-toggle="tab"
                                       href="#semestre{{ semestre.id }}">{{ semestre.libelle }}</a>
                                </li>
                            {% endfor %}
                        </ul>

                        <!-- Tab panes -->
                        <div class="tab-content">
                            {% for semestre in user_data.semestresByDiplome(diplome.id) %}
                                <div class="tab-pane {% if loop.first %}fade active show{% endif %}"
                                     id="semestre{{ semestre.id }}">
                                    <table class="table table-striped table-bordered" cellspacing="0"
                                           data-provide="datatables">
                                        <thead>
                                        <tr>
                                            <th>{{ 'table.code_apogee'|trans }}</th>
                                            <th>{{ 'table.refmatiere'|trans }}</th>
                                            <th>{{ 'table.libelle'|trans }}</th>
                                            <th>{{ 'table.cm'|trans }}</th>
                                            <th>{{ 'table.td'|trans }}</th>
                                            <th>{{ 'table.tp'|trans }}</th>
                                            <th>{{ 'table.nb_notes'|trans }}</th>
                                            <th>{{ 'table.coefficient'|trans }}.</th>
                                            <th>{{ 'table.nb_ects'|trans }}</th>
                                            <th>{{ 'table.pac'|trans }}</th>
                                            <th>{{ 'table.suspendu'|trans }}</th>
                                            <th>{{ 'table.actions'|trans }}</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        {% for matiere in matieres if matiere.semestre.id == semestre.id %}
                                            <tr>
                                                <td>{{ matiere.codeApogee }}</td>
                                                <td>{{ matiere.codeMatiere }}</td>
                                                <td>{{ matiere.libelle }}</td>
                                                <td>{{ matiere.cmPpn }} | {{ matiere.cmFormation }}</td>
                                                <td>{{ matiere.tdPpn }} | {{ matiere.tdFormation }}</td>
                                                <td>{{ matiere.tpPpn }} | {{ matiere.tpFormation }}</td>
                                                <td>{{ matiere.nbNotes }}</td>
                                                <td>{{ matiere.coefficient }}</td>
                                                <td>{{ matiere.nbEcts }}</td>
                                                <td>{{ matiere.suspendu ? 'Yes'|trans : 'No'|trans }}</td>
                                                <td>{{ matiere.pac ? 'Yes'|trans : 'No'|trans }}</td>
                                                <td>
                                                    {{ include('composants/adm-buttons-table-index.html.twig', {elt: 'matiere', id:matiere.id}) }}
                                                </td>
                                            </tr>
                                        {% else %}
                                            <tr class="bg-pale-warning">
                                                <td colspan="12">{{ 'no.record.found'|trans }}</td>
                                            </tr>
                                        {% endfor %}
                                        </tbody>
                                    </table>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
{% endblock %}

{% block fabactions %}
    {{ include('composants/fab-buttons.html.twig', {boutons:[
        {type: 'warning',
            href: path('administration_ppn_index'),
            title: 'gestion.ppn'|trans,
            icone : "ti-direction-alt"
        },
        {
            type:'info',
            href:path('help_article', {sujet: 'administration_matiere'}),
            title: 'aide'|trans,
            icone: 'fa fa-question',
            target: "_blank"
        }
    ]}) }}
{% endblock %}